(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function r(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,n(o.key),o)}}function n(e){var r=function(e){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(r)?r:r+""}var o=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=r):this.el=e,this.data={}}return n=t,o=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,r){var n,o=function(t){if(Array.isArray(t))return t}(n=t.split("."))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,r){if(t){if("string"==typeof t)return e(t,r);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,r):void 0}}(n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=o[0],l=o.slice(1),a=i;return"mousewheel"===a&&/Firefox/i.test(window.navigator.userAgent)&&(a="DOMMouseScroll"),this.el.addEventListener(a,(function(t){r(t);for(var e=0;e<l.length;e+=1){var n=l[e];if("left"===n&&0!==t.button)return;if("right"===n&&2!==t.button)return;"stop"===n&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(r){e.css(r,"".concat(t[r],"px"))})),this;var r=this.el;return{top:r.offsetTop,left:r.offsetLeft,height:r.offsetHeight,width:r.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return 0===arguments.length?this.el.childNodes:(r.forEach((function(e){return t.child(e)})),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var r=e;return"string"==typeof e?r=document.createTextNode(e):e instanceof t&&(r=e.el),this.el.appendChild(r),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?this.removeClass(t):this.addClass(t),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){return arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?this.removeClass("disabled"):this.addClass("disabled"),this}},{key:"attr",value:function(t,e){var r=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){r.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var r=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){r.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}],o&&r(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o}(),i=function(t){return new o(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")};function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function c(t){for(var e="",r=t;r>=a.length;)r/=a.length,r-=1,e+=a[parseInt(r,10)%a.length];return e+a[t%a.length]}function u(t){for(var e=0,r=0;r!==t.length;++r)e=26*e+t.charCodeAt(r)-64;return e-1}function s(t){for(var e="",r="",n=0;n<t.length;n+=1)t.charAt(n)>="0"&&t.charAt(n)<="9"?r+=t.charAt(n):e+=t.charAt(n);return[u(e),parseInt(r,10)-1]}function f(t,e){return"".concat(c(t)).concat(e+1)}function h(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===r)return t;var o,i,a=(o=s(t),i=2,function(t){if(Array.isArray(t))return t}(o)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(o,i)||function(t,e){if(t){if("string"==typeof t)return l(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}(o,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=a[0],u=a[1];return n(c,u)?f(c+e,u+r):t}function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return v(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b(n.key),n)}}function b(t){var e=function(t){if("object"!=y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==y(e)?e:e+""}var m=function(){function t(e,r,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=r,this.eri=n,this.eci=o,this.w=i,this.h=l}return function(t,e,r){return e&&d(t.prototype,e),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(t,[{key:"set",value:function(t,e,r,n){this.sri=t,this.sci=e,this.eri=r,this.eci=n}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];if(1===n.length){var i=p(s(n[0]),2);e=i[0],t=i[1]}else 2===n.length&&(t=n[0],e=n[1]);var l=this.sri,a=this.sci,c=this.eri,u=this.eci;return l<=t&&t<=c&&a<=e&&e<=u}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=this.sri,n=this.sci,o=this.eri,i=this.eci,l=r;l<=o;l+=1)if(e(l))for(var a=n;a<=i;a+=1)t(l,a)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var r=this.sri,n=this.sci,o=this.eri,i=this.eci;return new t(e.sri<r?e.sri:r,e.sci<n?e.sci:n,e.eri>o?e.eri:o,e.eci>i?e.eci:i)}},{key:"difference",value:function(e){var r=[],n=function(e,n,o,i){r.push(new t(e,n,o,i))},o=this.sri,i=this.sci,l=this.eri,a=this.eci,c=e.sri-o,u=e.sci-i,s=l-e.eri,f=a-e.eci;return c>0?(n(o,i,e.sri-1,a),s>0?(n(e.eri+1,i,l,a),u>0&&n(e.sri,i,e.eri,e.sci-1),f>0&&n(e.sri,e.eci+1,e.eri,a)):(u>0&&n(e.sri,i,l,e.sci-1),f>0&&n(e.sri,e.eci+1,l,a))):s>0&&(n(e.eri+1,i,l,a),u>0&&n(o,i,e.eri,e.sci-1),f>0&&n(o,e.eci+1,e.eri,a)),u>0?(n(o,i,l,e.sci-1),f>0?(n(o,e.eri+1,l,a),c>0&&n(o,e.sci,e.sri-1,e.eci),s>0&&n(e.sri+1,e.sci,l,e.eci)):(c>0&&n(o,e.sci,e.sri-1,a),s>0&&n(e.sri+1,e.sci,l,a))):f>0&&(n(l,e.eci+1,l,a),c>0&&n(o,i,e.sri-1,e.eci),s>0&&n(e.eri+1,i,l,e.eci)),r}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,r=this.eri,n=this.eci,o=f(e,t);return this.multiple()&&(o="".concat(o,":").concat(f(n,r))),o}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}],[{key:"valueOf",value:function(e){var r=e.split(":"),n=p(s(r[0]),2),o=n[0],i=n[1],l=i,a=o;if(r.length>1){var c=p(s(r[1]),2);a=c[0],l=c[1]}return new t(i,o,l,a)}}])}();function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,O(n.key),n)}}function O(t){var e=function(t){if("object"!=g(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==g(e)?e:e+""}var S=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new m(0,0,0,0),this.ri=0,this.ci=0},(e=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&w(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,P(n.key),n)}}function E(t,e,r){return e&&k(t.prototype,e),r&&k(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function P(t){var e=function(t){if("object"!=j(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==j(e)?e:e+""}var x=E((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0}));function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function _(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,C(n.key),n)}}function C(t){var e=function(t){if("object"!=T(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==T(e)?e:e+""}var A=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]},(e=[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var r=this.undoItems,n=this.redoItems;this.canUndo()&&(n.push(JSON.stringify(t)),e(JSON.parse(r.pop())))}},{key:"redo",value:function(t,e){var r=this.undoItems,n=this.redoItems;this.canRedo()&&(r.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}}])&&_(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,D(n.key),n)}}function D(t){var e=function(t){if("object"!=R(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==R(e)?e:e+""}var B=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear"},(e=[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&I(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function M(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,W(n.key),n)}}function N(t,e,r){return e&&H(t.prototype,e),r&&H(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function W(t){var e=function(t){if("object"!=z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==z(e)?e:e+""}var F=function(){return N((function t(e,r,n){M(this,t),this.ci=e,this.operator=r,this.value=n}),[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,r=this.value;return"all"===e||"in"===e&&r.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}])}(),U=function(){return N((function t(e,r){M(this,t),this.ci=e,this.order=r}),[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}])}(),L=function(){return N((function t(){M(this,t),this.ref=null,this.filters=[],this.sort=null}),[{key:"setData",value:function(t){var e=t.ref,r=t.filters,n=t.sort;null!=e&&(this.ref=e,this.filters=r.map((function(t){return new F(t.ci,t.operator,t.value)})),n&&(this.sort=new U(n.ci,n.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,r=this.sort;return{ref:t,filters:e.map((function(t){return t.getData()})),sort:r}}return{}}},{key:"addFilter",value:function(t,e,r){var n=this.getFilter(t);null==n?this.filters.push(new F(t,e,r)):n.set(e,r)}},{key:"setSort",value:function(t,e){this.sort=e?new U(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,r=0;r<e.length;r+=1)if(e[r].ci===t)return e[r];return null}},{key:"filteredRows",value:function(t){var e=new Set,r=new Set;if(this.active())for(var n=this.range(),o=n.sri,i=n.eri,l=this.filters,a=o+1;a<=i;a+=1)for(var c=0;c<l.length;c+=1){var u=l[c],s=t(a,u.ci),f=s?s.text:"";if(!u.includes(f)){e.add(a);break}r.add(a)}return{rset:e,fset:r}}},{key:"items",value:function(t,e){var r={};if(this.active())for(var n=this.range(),o=n.sri,i=n.eri,l=o+1;l<=i;l+=1){var a=e(l,t);if(null===a||/^\s*$/.test(a.text))r[""]=(r[""]||0)+1;else{var c=a.text,u=(r[c]||0)+1;r[c]=u}}return r}},{key:"range",value:function(){return m.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}])}();function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Y(n.key),n)}}function Y(t){var e=function(t){if("object"!=$(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$(e)?e:e+""}var X=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=e}return e=t,(r=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(t,e))return n}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"union",value:function(t){var e=t;return this._.forEach((function(t){t.intersects(e)&&(e=t.union(e))})),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,r,n){this._.forEach((function(o){var i=o.sri,l=o.sci,a=o.eri,c=o.eci,u=o;"row"===t?i>=e?(u.sri+=r,u.eri+=r):i<e&&e<=a&&(u.eri+=r,n(i,l,r,0)):"column"===t&&(l>=e?(u.sci+=r,u.eci+=r):l<e&&e<=c&&(u.eci+=r,n(i,l,0,r)))}))}},{key:"move",value:function(t,e,r){this._.forEach((function(n){var o=n;o.within(t)&&(o.eri+=e,o.sri+=e,o.sci+=r,o.eci+=r)}))}},{key:"setData",value:function(t){return this._=t.map((function(t){return m.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}])&&V(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r}(),q=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return r.forEach((function(e){Object.keys(e).forEach((function(r){var n=e[r];"string"==typeof n||"number"==typeof n||"boolean"==typeof n?t[r]=n:"function"!=typeof n&&!Array.isArray(n)&&n instanceof Object?(t[r]=t[r]||{},q(t[r],n)):t[r]=n}))})),t};function K(t){for(var e="".concat(t),r=0,n=!1,o=0;o<e.length;o+=1)!0===n&&(r+=1),"."===e.charAt(o)&&(n=!0);return r}function Z(t,e,r){if(Number.isNaN(e)||Number.isNaN(r))return e+t+r;var n=K(e),o=K(r),i=Number(e),l=Number(r),a=0;if("-"===t)a=i-l;else if("+"===t)a=i+l;else if("*"===t)a=i*l;else if("/"===t)return K(a=i/l)>5?a.toFixed(2):a;return a.toFixed(Math.max(n,o))}const J=function(t){var e=JSON.parse(JSON.stringify(t));for(var r in t){var n=t[r];(n instanceof Blob||n instanceof Node)&&(e[r]=n)}return e},G=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return q.apply(void 0,[{}].concat(e))},Q=function t(e,r){var n=Object.keys(e);if(n.length!==Object.keys(r).length)return!1;for(var o=0;o<n.length;o+=1){var i=n[o],l=e[i],a=r[i];if(void 0===a)return!1;if("string"==typeof l||"number"==typeof l||"boolean"==typeof l){if(l!==a)return!1}else if(Array.isArray(l)){if(l.length!==a.length)return!1;for(var c=0;c<l.length;c+=1)if(!t(l[c],a[c]))return!1}else if("function"!=typeof l&&!Array.isArray(l)&&l instanceof Object&&!t(l,a))return!1}return!0},tt=function(t,e,r){for(var n=0,o=t;o<e;o+=1)n+=r(o);return n},et=function(t,e,r,n,o,i){for(var l=r,a=n,c=t;c<e&&!(l>o);c+=1)l+=a=i(c);return[c,l-a,a]};function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function nt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ot(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ot(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function it(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lt(n.key),n)}}function lt(t){var e=function(t){if("object"!=rt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rt(e)?e:e+""}var at=function(){return t=function t(e){var r=e.len,n=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=r,this.height=n},e=[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var r=this.getOrNew(t);!0===e?r.hide=!0:delete r.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,r){var n=this;return tt(t,e,(function(t){return r&&r.has(t)?0:n.getHeight(t)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var r=this.get(t);return void 0!==r&&void 0!==r.cells&&void 0!==r.cells[e]?r.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var r=this.getCell(t,e);return r&&r.merge?r.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var r=this.getOrNew(t);return r.cells[e]=r.cells[e]||{},r.cells[e]}},{key:"setCell",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",o=this.getOrNew(t);"all"===n?o.cells[e]=r:"text"===n?(o.cells[e]=o.cells[e]||{},o.cells[e].text=r.text):"format"===n&&(o.cells[e]=o.cells[e]||{},o.cells[e].style=r.style,r.merge&&(o.cells[e].merge=r.merge))}},{key:"setCellText",value:function(t,e,r){var n=this.getCellOrNew(t,e);!1!==n.editable&&(n.text=r)}},{key:"copyPaste",value:function(t,e,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},l=t.sri,a=t.sci,c=t.eri,u=t.eci,s=e.sri,f=e.sci,y=e.eri,p=e.eci,v=nt(t.size(),2),d=v[0],b=v[1],m=nt(e.size(),2),g=m[0],w=m[1],O=!0,S=0;(y<l||p<a)&&(O=!1,S=y<l?g:w);for(var j=l;j<=c;j+=1)if(this._[j])for(var k=a;k<=u;k+=1)if(this._[j].cells&&this._[j].cells[k])for(var E=s;E<=y;E+=d)for(var P=function(){var t=E+(j-l),e=x+(k-a),v=J(n._[j].cells[k]);if(o&&v&&v.text&&v.text.length>0){var m=v.text,g=x-f+(E-s)+2;if(O||(g-=S+1),"="===m[0])v.text=m.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){var e=0,r=0;return l===s?e=g-1:r=g-1,/^\d+$/.test(t)?t:h(t,e,r)}));else if(d<=1&&b>1&&(s>c||y<l)||b<=1&&d>1&&(f>u||p<a)||d<=1&&b<=1){var w=/[\\.\d]+$/.exec(m);if(null!==w){var P=Number(w[0])+g-1;v.text=m.substring(0,w.index)+P}}}n.setCell(t,e,v,r),i(t,e,v)},x=f;x<=p;x+=b)P()}},{key:"cutPaste",value:function(t,e){var r=this,n={};this.each((function(o){r.eachCells(o,(function(i){var l=parseInt(o,10),a=parseInt(i,10);t.includes(o,i)&&(l=e.sri+(l-t.sri),a=e.sci+(a-t.sci)),n[l]=n[l]||{cells:{}},n[l].cells[a]=r._[o].cells[i]}))})),this._=n}},{key:"paste",value:function(t,e){var r=this;if(!(t.length<=0)){var n=e.sri,o=e.sci;t.forEach((function(t,e){var i=n+e;t.forEach((function(t,e){var n=o+e;r.setCellText(i,n,t)}))}))}}},{key:"insert",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n={};this.each((function(o,i){var l=parseInt(o,10);l>=t&&(l+=r,e.eachCells(o,(function(e,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return h(e,0,r,(function(e,r){return r>=t}))})))}))),n[l]=i})),this._=n,this.len+=r}},{key:"delete",value:function(t,e){var r=this,n=e-t+1,o={};this.each((function(i,l){var a=parseInt(i,10);a<t?o[a]=l:i>e&&(o[a-n]=l,r.eachCells(i,(function(t,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return h(t,0,-n,(function(t,r){return r>e}))})))})))})),this._=o,this.len-=n}},{key:"insertColumn",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each((function(n,o){var i={};e.eachCells(n,(function(e,n){var o=parseInt(e,10);o>=t&&(o+=r,n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return h(e,r,0,(function(e){return e>=t}))})))),i[o]=n})),o.cells=i}))}},{key:"deleteColumn",value:function(t,e){var r=this,n=e-t+1;this.each((function(o,i){var l={};r.eachCells(o,(function(r,o){var i=parseInt(r,10);i<t?l[i]=o:i>e&&(l[i-n]=o,o.text&&"="===o.text[0]&&(o.text=o.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return h(t,-n,0,(function(t){return t>e}))}))))})),i.cells=l}))}},{key:"deleteCells",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each((function(t,n){e.deleteCell(t,n,r)}))}},{key:"deleteCell",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",n=this.get(t);if(null!==n){var o=this.getCell(t,e);null!==o&&!1!==o.editable&&("all"===r?delete n.cells[e]:"text"===r?(o.text&&delete o.text,o.value&&delete o.value):"format"===r?(void 0!==o.style&&delete o.style,o.merge&&delete o.merge):"merge"===r&&o.merge&&delete o.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],r=this._[e];if(r){var n=r.cells,o=Object.keys(n),i=o[o.length-1];return[parseInt(e,10),parseInt(i,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach((function(e){var r=nt(e,2),n=r[0],o=r[1];t(n,o)}))}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach((function(t){var r=nt(t,2),n=r[0],o=r[1];e(n,o)}))}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}],e&&it(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function ut(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,st(n.key),n)}}function st(t){var e=function(t){if("object"!=ct(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ct(e)?e:e+""}var ft=function(){return t=function t(e){var r=e.len,n=e.width,o=e.indexWidth,i=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=r,this.width=n,this.indexWidth=o,this.minWidth=i},(e=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var r=this.getOrNew(t);!0===e?r.hide=!0:delete r.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var r=this;return tt(t,e,(function(t){return r.getWidth(t)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&ut(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var yt=["cn"],pt={cn:{toolbar:{undo:"撤销",redo:"恢复",print:"打印",paintformat:"格式刷",clearformat:"清除格式",format:"数据格式",fontName:"字体",fontSize:"字号",fontBold:"加粗",fontItalic:"倾斜",underline:"下划线",strike:"删除线",color:"字体颜色",bgcolor:"填充颜色",border:"边框",merge:"合并单元格",align:"水平对齐",valign:"垂直对齐",textwrap:"自动换行",freeze:"冻结",autofilter:"自动筛选",formula:"函数",more:"更多",sharp:"触发sharp事件"},contextmenu:{copy:"复制",cut:"剪切",paste:"粘贴",pasteValue:"粘贴数据",pasteFormat:"粘贴格式",pasteColsToRows:"粘贴列到行",pasteRowsToCols:"粘贴行到列",hide:"隐藏",insertRow:"插入行",insertColumn:"插入列",deleteSheet:"删除",deleteRow:"删除行",deleteColumn:"删除列",deleteCell:"删除",deleteCellText:"删除数据",validation:"数据验证",cellprintable:"可打印",cellnonprintable:"不可打印",celleditable:"可编辑",cellnoneditable:"不可编辑"},print:{size:"纸张大小",orientation:"方向",orientations:["横向","纵向"]},format:{normal:"正常",text:"文本",number:"数值",percent:"百分比",rmb:"人民币",usd:"美元",eur:"欧元",date:"短日期",time:"时间",datetime:"长日期",duration:"持续时间"},formula:{sum:"求和",average:"求平均值",max:"求最大值",min:"求最小值",concat:"字符拼接",_if:"条件判断",and:"和",or:"或"},validation:{required:"此值必填",notMatch:"此值不匹配验证规则",between:"此值应在 {} 和 {} 之间",notBetween:"此值不应在 {} 和 {} 之间",notIn:"此值不在列表中",equal:"此值应该等于 {}",notEqual:"此值不应该等于 {}",lessThan:"此值应该小于 {}",lessThanEqual:"此值应该小于等于 {}",greaterThan:"此值应该大于 {}",greaterThanEqual:"此值应该大于等于 {}"},error:{pasteForMergedCell:"无法对合并的单元格执行此操作"},calendar:{weeks:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},button:{next:"下一步",cancel:"取消",remove:"删除",save:"保存",ok:"确认"},sort:{desc:"降序",asc:"升序"},filter:{empty:"空白"},dataValidation:{mode:"模式",range:"单元区间",criteria:"条件",modeType:{cell:"单元格",column:"列模式",row:"行模式"},type:{list:"列表",number:"数字",date:"日期",phone:"手机号",email:"电子邮件"},operator:{be:"在区间",nbe:"不在区间",lt:"小于",lte:"小于等于",gt:"大于",gte:"大于等于",eq:"等于",neq:"不等于"}}}};function vt(t,e){if(e){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return ht(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ht(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return l=t.done,t},e:function(t){a=!0,i=t},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}(yt);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(!e[o])break;for(var i=e[o],l=t.match(/(?:\\.|[^.])+/g),a=0;a<l.length;a+=1){var c=i[l[a]];if(!c)break;if(a===l.length-1)return c;i=c}}}catch(t){n.e(t)}finally{n.f()}}}function dt(t){var e=vt(t,pt);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=vt(t,window.x_spreadsheet.$messages)),e||""}function bt(t){return function(){return dt(t)}}function mt(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?yt=[t]:yt.unshift(t),e&&(pt[t]=e)}function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ot(n.key),n)}}function Ot(t){var e=function(t){if("object"!=gt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=gt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gt(e)?e:e+""}function St(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(t,e)||jt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jt(t,e){if(t){if("string"==typeof t)return kt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?kt(t,e):void 0}}function kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var Et={mode:"edit",showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}};function Pt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=this.merges,o=e.clone(),i=St(t.size(),2),l=i[0],a=i[1],c=St(e.size(),2),u=c[0],s=c[1];return l>u&&(o.eri=e.sri+l-1),a>s&&(o.eci=e.sci+a-1),!n.intersects(o)||(r(dt("error.pasteForMergedCell")),!1)}function xt(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.rows,i=this.merges;"all"!==r&&"format"!==r||(o.deleteCells(e,r),i.deleteWithin(e)),o.copyPaste(t,e,r,n,(function(t,e,r){if(r&&r.merge){var n=St(r.merge,2),o=n[0],l=n[1];if(o<=0&&l<=0)return;i.add(new m(t,e,t+o,e+l))}}))}function Tt(t,e){var r=this.clipboard,n=this.rows,o=this.merges;n.cutPaste(t,e),o.move(t,e.sri-t.sri,e.sci-t.sci),r.clear()}function _t(t,e,r){var n=this.styles,o=this.rows.getCellOrNew(t,e),i={};void 0!==o.style&&(i=J(n[o.style])),i=G(i,{border:r}),o.style=this.addStyle(i)}function Ct(t){var e=this,r=t.mode,n=t.style,o=t.color,i=this.styles,l=this.selector,a=this.rows,c=l.range,u=c.sri,s=c.sci,f=c.eri,h=c.eci,y=!this.isSingleSelected();if(y||"inside"!==r&&"horizontal"!==r&&"vertical"!==r)if("outside"!==r||y){if("none"===r)l.range.each((function(t,r){var n=a.getCell(t,r);if(n&&void 0!==n.style){var o=J(i[n.style]);delete o.border,n.style=e.addStyle(o)}}));else if("all"===r||"inside"===r||"outside"===r||"horizontal"===r||"vertical"===r)for(var p=[],v=u;v<=f;v+=1)for(var d=s;d<=h;d+=1){for(var b=[],m=0;m<p.length;m+=1){var g=St(p[m],4),w=g[0],O=g[1],S=g[2],j=g[3];if(v===w+S+1&&b.push(m),w<=v&&v<=w+S&&d===O){d+=j+1;break}}if(b.forEach((function(t){return p.splice(t,1)})),d>h)break;var k=a.getCell(v,d),E=0,P=0;if(k&&k.merge){var x=St(k.merge,2);E=x[0],P=x[1],p.push([v,d,E,P])}var T=E>0&&v+E===f,_=P>0&&d+P===h,C={};"all"===r?C={bottom:[n,o],top:[n,o],left:[n,o],right:[n,o]}:"inside"===r?(!_&&d<h&&(C.right=[n,o]),!T&&v<f&&(C.bottom=[n,o])):"horizontal"===r?!T&&v<f&&(C.bottom=[n,o]):"vertical"===r?!_&&d<h&&(C.right=[n,o]):"outside"===r&&y&&(u===v&&(C.top=[n,o]),(T||f===v)&&(C.bottom=[n,o]),s===d&&(C.left=[n,o]),(_||h===d)&&(C.right=[n,o])),Object.keys(C).length>0&&_t.call(this,v,d,C),d+=P}else if("top"===r||"bottom"===r)for(var A=s;A<=h;A+=1)"top"===r&&(_t.call(this,u,A,{top:[n,o]}),A+=a.getCellMerge(u,A)[1]),"bottom"===r&&(_t.call(this,f,A,{bottom:[n,o]}),A+=a.getCellMerge(f,A)[1]);else if("left"===r||"right"===r)for(var R=u;R<=f;R+=1)"left"===r&&(_t.call(this,R,s,{left:[n,o]}),R+=a.getCellMerge(R,s)[0]),"right"===r&&(_t.call(this,R,h,{right:[n,o]}),R+=a.getCellMerge(R,h)[0])}else _t.call(this,u,s,{top:[n,o],bottom:[n,o],left:[n,o],right:[n,o]})}function At(t,e){var r=this.rows,n=this.freezeTotalHeight(),o=r.height;n+r.height<t&&(o-=e);for(var i=this.exceptRowSet,l=0,a=o,c=r.height;l<r.len&&!(a>t);l+=1)i.has(l)||(a+=c=r.getHeight(l));return(a-=c)<=0?{ri:-1,top:0,height:c}:{ri:l-1,top:a,height:c}}function Rt(t,e){var r=this.cols,n=this.freezeTotalWidth(),o=r.indexWidth;n+r.indexWidth<t&&(o-=e);var i=St(et(0,r.len,o,r.indexWidth,t,(function(t){return r.getWidth(t)})),3),l=i[0],a=i[1],c=i[2];return a<=0?{ci:-1,left:0,width:r.indexWidth}:{ci:l-1,left:a,width:c}}var It=function(){return t=function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.targetEl=e,this.settings=G(Et,n||{}),this.name=r||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new X,this.rows=new at(this.settings.row),this.cols=new ft(this.settings.col),this.hyperlinks={},this.comments={},this.selector=new S,this.scroll=new x,this.history=new A,this.clipboard=new B,this.autoFilter=new L,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map},e=[{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),(function(e){t.setData(e)}))}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),(function(e){t.setData(e)}))}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"copyToSystemClipboard",value:function(t){for(var e=[],r=this.selector.range,n=r.sri,o=r.eri,i=r.sci,l=r.eci,a=n;a<=o;a+=1){for(var c=[],u=i;u<=l;u+=1){var s=this.getCell(a,u);c.push(s&&s.text||"")}e.push(c)}e=e.map((function(t){return t.join("\t")})).join("\n"),t&&(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",e),t.preventDefault()),navigator.clipboard&&navigator.clipboard.writeText(e).then((function(){}),(function(t){console.log("text copy to the system clipboard error  ",e,t)}))}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.clipboard,o=this.selector;return!n.isClear()&&!!Pt.call(this,n.range,o.range,r)&&(this.changeData((function(){n.isCopy()?xt.call(t,n.range,o.range,e):n.isCut()&&Tt.call(t,n.range,o.range)})),!0)}},{key:"parseHtmlTable",value:function(t){var e=document.createElement("div");e.innerHTML=t;var r=e.querySelector("table");if(!r)return this.parseClipboardContent(e.innerText);var n=r.querySelectorAll("tr"),o=[];return n.forEach((function(t){var e=[];t.querySelectorAll("td, th").forEach((function(t){e.push(t.innerText.trim())})),o.push(e)})),o}},{key:"pasteFromSystemClipboard",value:function(t,e,r){var n=this,o=this.selector;navigator.clipboard.read().then((function(o){var l,a=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=jt(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){l=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(l)throw o}}}}(o);try{for(a.s();!(l=a.n()).done;){for(var c=l.value,u=0;u<c.types.length;u++){var s=c.types[u];if(s.startsWith("image/"))return void c.getType(s).then((function(r){var o;(o=r,new Promise((function(t){var e=new Image;e.onload=function(){return t(e)},e.onerror=function(){console.error("Failed to load image:",o),t(null)},"string"==typeof o?e.src=o:o instanceof Blob?e.src=URL.createObjectURL(o):t(null)}))).then((function(o){o&&(n.setSelectedCellAttr("image",o),n.setSelectedCellAttr("blob",r),t(),e(n.rows.getData()))}))}))}if(c.types.includes("text/html"))return void c.getType("text/html").then((function(t){t.text().then((function(t){var e=n.parseHtmlTable(t);i(e,r)}))}));if(c.types.includes("text/plain"))return void c.getType("text/plain").then((function(t){t.text().then((function(t){var e=n.parseClipboardContent(t);i(e,r)}))}))}}catch(t){a.e(t)}finally{a.f()}}));var i=function(r,i){"colsToRows"!==i&&"rowsToCols"!==i||(r=n.transposeArray(r)),n.autoInsertColsRows(r);var l=o.ri;r.forEach((function(t){var e=o.ci;t.forEach((function(t){n.setCellText(l,e,t,"input"),e+=1})),l+=1})),t(),e(n.rows.getData())}}},{key:"autoInsertColsRows",value:function(t){var e=this.selector,r=this.rows,n=this.cols,o=t.length,i=t[0].length,l=e.ri,a=e.ci,c=i-n.len+a;c>0&&(n.len+=c);var u=o-r.len+l;u>0&&(r.len+=u)}},{key:"transposeArray",value:function(t){if(0===t.length)return[];for(var e=t.length,r=t[0].length,n=[],o=0;o<r;o++){n[o]=[];for(var i=0;i<e;i++)n[o][i]=t[i][o]||""}return n}},{key:"parseClipboardContent",value:function(t){var e=[],r=t.split(/[\r]?[\n]/g),n=0;return r.forEach((function(t){e[n]=t.split("\t"),n+=1})),e}},{key:"pasteFromText",value:function(t){var e;if((e=/\r\n/.test(t)?t.split("\r\n").map((function(t){return t.replace(/"/g,"").split("\t")})):t.split("\n").map((function(t){return t.replace(/"/g,"").split("\t")}))).length){var r=this.rows,n=this.selector;this.changeData((function(){r.paste(e,n.range)}))}}},{key:"autofill",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=this.selector.range;return!!Pt.call(this,o,t,n)&&(this.changeData((function(){xt.call(r,o,t,e,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var r=this.selector,n=this.rows,o=this.cols,i=this.merges,l=r.range,a=l.sri,c=l.sci,u=l.eri,s=l.eci,f=r.ri,h=r.ci,y=t,p=e;return t<0&&(y=n.len-1),e<0&&(p=o.len-1),y>f?(a=f,u=y):(a=y,u=f),p>h?(c=h,s=p):(c=p,s=h),r.range=i.union(new m(a,c,u,s)),r.range=i.union(r.range),r.range}},{key:"calSelectedRangeByStart",value:function(t,e){var r=this.selector,n=this.rows,o=this.cols,i=this.merges.getFirstIncludes(t,e);return null===i&&(i=new m(t,e,t,e),-1===t&&(i.sri=0,i.eri=n.len-1),-1===e&&(i.sci=0,i.eci=o.len-1)),r.range=i,i}},{key:"setSelectedCellAttr",value:function(t,e){var r=this;this.changeData((function(){var n=r.selector,o=r.styles,i=r.rows;if("merge"!==t)if("border"!==t)if("formula"!==t)n.range.each((function(n,l){var a=i.getCellOrNew(n,l),c={};if(void 0!==a.style&&(c=J(o[a.style])),"format"===t)return c.format=e,void(a.style=r.addStyle(c));if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var u={};return u[t.split("-")[1]]=e,c.font=Object.assign(c.font||{},u),void(a.style=r.addStyle(c))}if("strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t)return c[t]=e,void(a.style=r.addStyle(c));a[t]=e}));else{var l=n.ri,a=n.ci,c=n.range;if(n.multiple()){var u=St(n.size(),2),s=u[0],h=u[1],y=c.sri,p=c.sci,v=c.eri,d=c.eci;if(s>1)for(var b=p;b<=d;b+=1)i.getCellOrNew(v+1,b).text="=".concat(e,"(").concat(f(b,y),":").concat(f(b,v),")");else h>1&&(i.getCellOrNew(l,d+1).text="=".concat(e,"(").concat(f(p,l),":").concat(f(d,l),")"));return}i.getCellOrNew(l,a).text="=".concat(e,"()")}else Ct.call(r,e);else e?r.merge():r.unmerge()}))}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",r=this.autoFilter,n=this.selector,o=this.rows,i=n.ri,l=n.ci,a=i;this.unsortedRowMap.has(i)&&(a=this.unsortedRowMap.get(i));var c=o.getCell(a,l),u=c?c.text:"";if(this.setCellText(a,l,t,e),r.active()){var s=r.getFilter(l);if(s){var f=s.value.findIndex((function(t){return t===u}));f>=0&&s.value.splice(f,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=e;return this.unsortedRowMap.has(e)&&(n=this.unsortedRowMap.get(e)),this.rows.getCell(n,r)}},{key:"xyInSelectedRect",value:function(t,e){var r=this.getSelectedRect(),n=r.left,o=r.top,i=r.width,l=r.height,a=t-this.cols.indexWidth,c=e-this.rows.height;return a>n&&a<n+i&&c>o&&c<o+l}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,r=this.rows,n=this.cols,o=this.exceptRowSet,i=t.sri,l=t.sci,a=t.eri,c=t.eci;if(i<0&&l<0)return{left:0,l:0,top:0,t:0,scroll:e};var u=n.sumWidth(0,l),s=r.sumHeight(0,i,o),f=r.sumHeight(i,a+1,o),h=n.sumWidth(l,c+1),y=u-e.x,p=s-e.y,v=this.freezeTotalHeight(),d=this.freezeTotalWidth();return d>0&&d>u&&(y=u),v>0&&v>s&&(p=s),{l:u,t:s,left:y,top:p,height:f,width:h,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var r=this.scroll,n=this.merges,o=this.rows,i=this.cols,l=At.call(this,e,r.y),a=l.ri,c=l.top,u=l.height,s=Rt.call(this,t,r.x),f=s.ci,h=s.left,y=s.width;if(-1===f&&(y=i.totalWidth()),-1===a&&(u=o.totalHeight()),a>=0||f>=0){var p=n.getFirstIncludes(a,f);if(p){a=p.sri,f=p.sci;var v=this.cellRect(a,f);h=v.left,c=v.top,y=v.width,u=v.height}}return{ri:a,ci:f,left:h,top:c,width:y,height:u}}},{key:"isSingleSelected",value:function(){var t=this.selector.range,e=t.sri,r=t.sci,n=t.eri,o=t.eci,i=this.getCell(e,r);if(i&&i.merge){var l=St(i.merge,2),a=l[0],c=l[1];if(e+a===n&&r+c===o)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,r=t.sci,n=t.eri,o=t.eci,i=this.getCell(e,r);if(i&&i.merge){var l=St(i.merge,2),a=l[0],c=l[1];if(e+a===n&&r+c===o)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,r=this.rows;if(!this.isSingleSelected()){var n=St(e.size(),2),o=n[0],i=n[1];if(o>1||i>1){var l=e.range,a=l.sri,c=l.sci;this.changeData((function(){var n=r.getCellOrNew(a,c);n.merge=[o-1,i-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(a,c,n)}))}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSingleSelected()){var r=e.range,n=r.sri,o=r.sci;this.changeData((function(){t.rows.deleteCell(n,o,"merge"),t.merges.deleteWithin(e.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,r=this.selector;this.changeData((function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=r.range.toString()}))}},{key:"setAutoFilter",value:function(t,e,r,n){var o=this.autoFilter;o.addFilter(t,r,n),o.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,r=this.rows;if(e.active()){var n=e.sort,o=e.filteredRows((function(t,e){return r.getCell(t,e)})),i=o.rset,l=o.fset,a=Array.from(l),c=Array.from(l);n&&a.sort((function(t,e){return"asc"===n.order?t-e:"desc"===n.order?e-t:0})),this.exceptRowSet=i,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,a.forEach((function(e,r){t.sortedRowMap.set(c[r],e),t.unsortedRowMap.set(e,c[r])}))}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=this.selector;this.changeData((function(){t.rows.deleteCells(r.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(r.range)}))}},{key:"insert",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData((function(){var n=e.selector.range,o=n.sri,i=n.sci,l=e.rows,a=e.merges,c=e.cols,u=o;"row"===t?l.insert(o,r):"column"===t&&(l.insertColumn(i,r),u=i,c.len+=r,Object.keys(c._).reverse().forEach((function(t){var e=parseInt(t,10);e>=i&&(c._[e+r]=c._[e],delete c._[e])}))),a.shift(t,u,r,(function(t,e,r,n){var o=l.getCell(t,e);o.merge[0]+=r,o.merge[1]+=n}))}))}},{key:"delete",value:function(t){var e=this;this.changeData((function(){var r=e.rows,n=e.merges,o=e.selector,i=e.cols,l=o.range,a=o.range,c=a.sri,u=a.sci,s=a.eri,f=a.eci,h=St(o.range.size(),2),y=h[0],p=h[1],v=c,d=y;"row"===t?r.delete(c,s):"column"===t&&(r.deleteColumn(u,f),v=l.sci,d=p,i.len-=f-u+1,Object.keys(i._).forEach((function(t){var e=parseInt(t,10);e>=u&&(e>f&&(i._[e-(f-u+1)]=i._[e]),delete i._[e])}))),n.shift(t,v,-d,(function(t,e,n,o){var i=r.getCell(t,e);i.merge[0]+=n,i.merge[1]+=o,0===i.merge[0]&&0===i.merge[1]&&delete i.merge}))}))}},{key:"scrollx",value:function(t,e){var r=this.scroll,n=this.freeze,o=this.cols,i=St(n,2)[1],l=St(et(i,o.len,0,0,t,(function(t){return o.getWidth(t)})),3),a=l[0],c=l[1],u=l[2],s=c;t>0&&(s+=u),r.x!==s&&(r.ci=t>0?a:0,r.x=s,e())}},{key:"scrolly",value:function(t,e){var r=this.scroll,n=this.freeze,o=this.rows,i=St(n,1)[0],l=St(et(i,o.len,0,0,t,(function(t){return o.getHeight(t)})),3),a=l[0],c=l[1],u=l[2],s=c;t>0&&(s+=u),r.y!==s&&(r.ri=t>0?a:0,r.y=s,e())}},{key:"cellRect",value:function(t,e){var r=this.rows,n=this.cols,o=n.sumWidth(0,e),i=r.sumHeight(0,t),l=r.getCell(t,e),a=n.getWidth(e),c=r.getHeight(t);if(null!==l&&l.merge){var u=St(l.merge,2),s=u[0],f=u[1];if(s>0)for(var h=1;h<=s;h+=1)c+=r.getHeight(t+h);if(f>0)for(var y=1;y<=f;y+=1)a+=n.getWidth(e+y)}return{left:o,top:i,width:a,height:c,cell:l}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCells",value:function(t){var e=this.rows,r=[];return t.range.each((function(t,n){return r.push(e.getCellOrNew(t,n))})),r}},{key:"getCellTextOrDefault",value:function(t,e){var r=this.getCell(t,e);return r&&r.text?r.text:""}},{key:"getCellStyle",value:function(t,e){var r=this.getCell(t,e);return r&&void 0!==r.style?this.styles[r.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var r=this.styles,n=this.rows.getCell(t,e),o=n&&void 0!==n.style?r[n.style]:{};return G(this.defaultStyle(),o)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,r=t.ci;return this.getCellStyleOrDefault(e,r)}},{key:"setCellText",value:function(t,e,r,n){var o=this.rows,i=this.history;"finished"===n?(o.setCellText(t,e,""),i.add(this.getData()),o.setCellText(t,e,r)):(o.setCellText(t,e,r),this.change(this.getData()))}},{key:"freezeIsActive",value:function(){var t=St(this.freeze,2),e=t[0],r=t[1];return e>0||r>0}},{key:"setFreeze",value:function(t,e){var r=this;this.changeData((function(){r.freeze=[t,e]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var r=this;this.changeData((function(){r.rows.setHeight(t,e)}))}},{key:"setColWidth",value:function(t,e){var r=this;this.changeData((function(){r.cols.setWidth(t,e)}))}},{key:"viewHeight",value:function(){var t,e=this.settings,r=e.showToolbar,n=e.showBottomBar,o=this.targetEl.el,i=(null===(t=(null==o?void 0:o.host)||o)||void 0===t?void 0:t.clientHeight)||0;return n&&(i-=41),r&&(i-=41),i}},{key:"viewWidth",value:function(){var t,e=this.targetEl.el;return(null===(t=(null==e?void 0:e.host)||e)||void 0===t?void 0:t.clientWidth)||0}},{key:"freezeViewRange",value:function(){var t=St(this.freeze,2),e=t[0],r=t[1];return new m(0,0,e-1,r-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,r=St(t.maxCell(),2),n=r[0],o=r[1],i=t.sumHeight(0,n+1),l=e.sumWidth(0,o+1);return new m(0,0,n,o,l,i)}},{key:"exceptRowTotalHeight",value:function(t,e){var r=this.exceptRowSet,n=this.rows,o=Array.from(r),i=0;return o.forEach((function(r){if(r<t||r>e){var o=n.getHeight(r);i+=o}})),i}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,r=this.cols,n=this.freeze,o=this.exceptRowSet,i=t.ri,l=t.ci;i<=0&&(i=St(n,1)[0]),l<=0&&(l=St(n,2)[1]);for(var a=0,c=0,u=[e.len,r.len],s=u[0],f=u[1],h=i;h<e.len&&(o.has(h)||(c+=e.getHeight(h),s=h),!(c>this.viewHeight()));h+=1);for(var y=l;y<r.len&&(f=y,!((a+=r.getWidth(y))>this.viewWidth()));y+=1);return new m(i,l,s,f,a,c)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach((function(t){return e(t)}))}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,r=this.selector,n=St(r.size(),2),o=n[0],i=n[1],l=r.range,a=l.sri,c=l.sci,u=l.eri,s=l.eci;if(o===t.len)for(var f=c;f<=s;f+=1)e.setHide(f,!0);else if(i===e.len)for(var h=a;h<=u;h+=1)t.setHide(h,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,r){for(var n=0,o=this.rows,i=this.exceptRowSet,l=function(t){if(Array.isArray(t))return kt(t)}(u=i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(u)||jt(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=0,c=0;c<l.length;c+=1)l[c]<t&&(a+=1);for(var u,s=t+a;s<=e+a;s+=1)if(i.has(s))a+=1;else{var f=o.getHeight(s);if(f>0&&(r(s,n,f),(n+=f)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,r){for(var n=0,o=this.cols,i=t;i<=e;i+=1){var l=o.getWidth(i);if(l>0&&(r(i,n,l),(n+=l)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,r=0;r<e.length;r+=1){var n=e[r];if(Q(n,t))return r}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach((function(r){if("merges"===r||"rows"===r||"cols"===r)e[r].setData(t[r]);else if("freeze"===r){var n=St(s(t[r]),2),o=n[0],i=n[1];e.freeze=[i,o]}else"autofilter"===r?e.autoFilter.setData(t[r]):void 0!==t[r]&&(e[r]=t[r])})),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,r=this.styles,n=this.merges,o=this.rows,i=this.cols,l=this.autoFilter;return{name:t,freeze:f(e[1],e[0]),styles:r,merges:n.getData(),rows:o.getData(),cols:i.getData(),autofilter:l.getData()}}}],e&&wt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Dt(t,e){if(t){if("string"==typeof t)return Bt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bt(t,e):void 0}}function Bt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function zt(t,e,r){t.addEventListener(e,r)}function Mt(t,e,r){t.removeEventListener(e,r)}function Ht(t,e,r){zt(t,"mousemove",e),t.xEvtUp=function(n){Mt(t,"mousemove",e),Mt(t,"mouseup",t.xEvtUp),r(n)},zt(t,"mouseup",t.xEvtUp)}function Nt(t,e,r,n){Math.abs(t)>Math.abs(e)?n(t>0?"right":"left",t,r):n(e>0?"down":"up",e,r)}var Wt="x-spreadsheet";function Ft(t){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ft(t)}function Ut(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lt(n.key),n)}}function Lt(t){var e=function(t){if("object"!=Ft(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ft(e)?e:e+""}window.devicePixelRatio;var $t=function(){return t=function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.moving=!1,this.vertical=r,this.el=i("div","".concat(Wt,"-resizer ").concat(r?"vertical":"horizontal")).children(this.unhideHoverEl=i("div","".concat(Wt,"-resizer-hover")).on("dblclick.stop",(function(t){return e.mousedblclickHandler(t)})).css("position","absolute").hide(),this.hoverEl=i("div","".concat(Wt,"-resizer-hover")).on("mousedown.stop",(function(t){return e.mousedownHandler(t)})),this.lineEl=i("div","".concat(Wt,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=n,this.unhideFn=function(){}},e=[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var r=this.moving,n=this.vertical,o=this.hoverEl,i=this.lineEl,l=this.el,a=this.unhideHoverEl;if(!r){this.cRect=t;var c=t.left,u=t.top,s=t.width,f=t.height;l.offset({left:n?c+s-5:c,top:n?u:u+f-5}).show(),o.offset({width:n?5:s,height:n?f:5}),i.offset({width:n?0:e.width,height:n?e.height:0}),a.offset({left:n?5-s:c,top:n?u:5-f,width:n?5:s,height:n?f:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,r=t,n=this.el,o=this.lineEl,i=this.cRect,l=this.vertical,a=this.minDistance,c=l?i.width:i.height;o.show(),Ht(window,(function(t){e.moving=!0,null!==r&&1===t.buttons&&(l?(c+=t.movementX)>a&&n.css("left","".concat(i.left+c,"px")):(c+=t.movementY)>a&&n.css("top","".concat(i.top+c,"px")),r=t)}),(function(){r=null,o.hide(),e.moving=!1,e.hide(),e.finishedFn&&(c<a&&(c=a),e.finishedFn(i,c))}))}}],e&&Ut(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Vt(t){return Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vt(t)}function Yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xt(n.key),n)}}function Xt(t){var e=function(t){if("object"!=Vt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Vt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Vt(e)?e:e+""}var qt=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=i("div","".concat(Wt,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=i("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(t){var e=t.target,n=e.scrollTop,o=e.scrollLeft;r.moveFn&&r.moveFn(r.vertical?n:o,t)}))},(e=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var r=t-1;if(e>r){var n=this.vertical?"height":"width";this.el.css(n,"".concat(r-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(n,"".concat(e,"px"))}else this.el.hide();return this}}])&&Yt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Kt(t){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt(t)}function Zt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qt(n.key),n)}}function Gt(t,e,r){return e&&Jt(t.prototype,e),r&&Jt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qt(t){var e=function(t){if("object"!=Kt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Kt(e)?e:e+""}var te=10,ee=function(){return Gt((function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Zt(this,t),this.useHideInput=r,this.autoFocus=n,this.inputChange=function(){},this.cornerEl=i("div","".concat(Wt,"-selector-corner")),this.areaEl=i("div","".concat(Wt,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=i("div","".concat(Wt,"-selector-clipboard")).hide(),this.autofillEl=i("div","".concat(Wt,"-selector-autofill")).hide(),this.el=i("div","".concat(Wt,"-selector")).css("z-index","".concat(te)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),r&&(this.hideInput=i("input","").on("compositionend",(function(t){e.inputChange(t.target.value)})),this.el.child(this.hideInputDiv=i("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=i("div","hide-input").child(this.hideInput))),te+=1}),[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,r=t.top,n={width:t.width-3+.8,height:t.height-3+.8,left:e-.8,top:r-.8};this.areaEl.offset(n).show(),this.useHideInput&&(this.hideInputDiv.offset(n),this.autoFocus?this.hideInput.val("").focus():this.hideInput.val(""))}},{key:"setClipboardOffset",value:function(t){var e=t.left,r=t.top,n=t.width,o=t.height;this.clipboardEl.offset({left:e,top:r,width:n-5,height:o-5})}},{key:"showAutofill",value:function(t){var e=t.left,r=t.top,n=t.width,o=t.height;this.autofillEl.offset({width:n-3,height:o-3,left:e,top:r}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}])}();function re(t){var e=this.data,r=t.left,n=t.top,o=t.width,i=t.height,l=t.scroll,a=t.l,c=t.t,u=e.freezeTotalWidth(),s=e.freezeTotalHeight(),f=r-u;u>a&&(f-=l.x);var h=n-s;return s>c&&(h-=l.y),{left:f,top:h,width:o,height:i}}function ne(t){var e=this.data,r=t.left,n=t.width,o=t.height,i=t.l,l=t.t,a=t.scroll,c=e.freezeTotalWidth(),u=r-c;return c>i&&(u-=a.x),{left:u,top:l,width:n,height:o}}function oe(t){var e=this.data,r=t.top,n=t.width,o=t.height,i=t.l,l=t.t,a=t.scroll,c=e.freezeTotalHeight(),u=r-c;return c>l&&(u-=a.y),{left:i,top:u,width:n,height:o}}function ie(t){this.br.setAreaOffset(re.call(this,t))}function le(t){this.tl.setAreaOffset(t)}function ae(t){this.t.setAreaOffset(ne.call(this,t))}function ce(t){this.l.setAreaOffset(oe.call(this,t))}function ue(t){this.l.setClipboardOffset(oe.call(this,t))}function se(t){this.br.setClipboardOffset(re.call(this,t))}function fe(t){this.tl.setClipboardOffset(t)}function he(t){this.t.setClipboardOffset(ne.call(this,t))}function ye(t){ie.call(this,t),le.call(this,t),ae.call(this,t),ce.call(this,t)}function pe(t){se.call(this,t),fe.call(this,t),he.call(this,t),ue.call(this,t)}var ve=function(){return Gt((function t(e){var r=this;Zt(this,t);var n=e.settings.autoFocus;this.inputChange=function(){},this.data=e,this.br=new ee(!0,n),this.t=new ee,this.l=new ee,this.tl=new ee,this.br.inputChange=function(t){r.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=i("div","".concat(Wt,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,te+=1}),[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,r=this.t,n=this.l,o=this.br,i=t.freezeTotalHeight(),l=t.freezeTotalWidth();i>0||l>0?(e.setOffset({width:l,height:i}),r.setOffset({left:l,height:i}),n.setOffset({top:i,width:l}),o.setOffset({left:l,top:i})):(e.hide(),r.hide(),n.hide(),o.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();ye.call(this,t),pe.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();ie.call(this,t),ae.call(this,t),se.call(this,e),he.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();ie.call(this,t),ce.call(this,t),se.call(this,e),ue.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,o=n.calSelectedRangeByStart(t,e),i=o.sri,l=o.sci;if(r){var a=t,c=e;t<0&&(a=0),e<0&&(c=0),n.selector.setIndexes(a,c),this.indexes=[a,c]}this.moveIndexes=[i,l],this.range=o,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,o=this.lastri,i=this.lastci;if(r){if(t===o&&e===i)return;this.lastri=t,this.lastci=e}this.range=n.calSelectedRangeByEnd(t,e),ye.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,r=t.eci;this.setEnd(e,r)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var r=this.range,n=r.sri,o=r.sci,i=r.eri,l=r.eci,a=t,c=e,u=n-t,s=i-t,f=l-e;if(o-e>0)this.arange=new m(n,c,i,o-1);else if(u>0)this.arange=new m(a,o,n-1,l);else if(f<0)this.arange=new m(n,l+1,i,c);else{if(!(s<0))return void(this.arange=null);this.arange=new m(i+1,o,a,l)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var y=this.br,p=this.l,v=this.t,d=this.tl;y.showAutofill(re.call(this,h)),p.showAutofill(oe.call(this,h)),v.showAutofill(ne.call(this,h)),d.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideAutofill()}))}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();pe.call(this,e),["br","l","t","tl"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideClipboard()}))}}])}();function de(t){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},de(t)}function be(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function me(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ge(n.key),n)}}function ge(t){var e=function(t){if("object"!=de(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=de(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==de(e)?e:e+""}function we(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}function Oe(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}function Se(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}function je(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:case 39:default:t.stopPropagation();break;case 38:we.call(this,t);break;case 40:Oe.call(this,t);break;case 13:case 9:Se.call(this,t)}}var ke=function(){return t=function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterItems=[],this.items=e,this.el=i("div","".concat(Wt,"-suggest")).css("width",n).hide(),this.itemClick=r,this.itemIndex=-1},e=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide()}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,r,n=this,o=this.items;/^\s*$/.test(t)||(o=o.filter((function(e){return(e.key||e).startsWith(t.toUpperCase())}))),o=o.map((function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var r=i("div","".concat(Wt,"-item")).child(e).on("click.stop",(function(){n.itemClick(t),n.hide()}));return t.label&&r.child(i("div","label").html(t.label)),r})),this.filterItems=o,o.length<=0||(e=this.el.html("")).children.apply(e,(r=o,function(t){if(Array.isArray(t))return be(t)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return be(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?be(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).show()}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",(function(t){return je.call(e,t)}))}}],e&&me(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Ee(t){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ee(t)}function Pe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xe(n.key),n)}}function xe(t){var e=function(t){if("object"!=Ee(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ee(e)?e:e+""}function Te(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Te=function(){return!!t})()}function _e(t){return _e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_e(t)}function Ce(t,e){return Ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ce(t,e)}var Ae=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=_e(e),function(t,e){if(e&&("object"==Ee(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Te()?Reflect.construct(e,r||[],_e(t).constructor):e.apply(t,r))}(this,e,["div","".concat(Wt,"-icon")])).iconNameEl=i("div","".concat(Wt,"-icon-img ").concat(t)),r.child(r.iconNameEl),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ce(t,e)}(e,t),r=e,(n=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(Wt,"-icon-img ").concat(t))}}])&&Pe(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(o);function Re(t){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Re(t)}function Ie(t){return function(t){if(Array.isArray(t))return De(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return De(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?De(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function De(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Be(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ze(n.key),n)}}function ze(t){var e=function(t){if("object"!=Re(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Re(e)?e:e+""}function Me(t,e){t.setMonth(t.getMonth()+e)}function He(t,e){var r=new Date(t);return r.setDate(e-t.getDay()+1),r}var Ne=function(){return t=function t(e){var r,n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=i("div","calendar-header-left"),this.bodyEl=i("tbody",""),this.buildAll(),this.el=i("div","x-spreadsheet-calendar").children(i("div","calendar-header").children(this.headerLeftEl,i("div","calendar-header-right").children(i("a","calendar-prev").on("click.stop",(function(){return n.prev()})).child(new Ae("chevron-left")),i("a","calendar-next").on("click.stop",(function(){return n.next()})).child(new Ae("chevron-right")))),i("table","calendar-body").children(i("thead","").child((r=i("tr","")).children.apply(r,Ie(dt("calendar.weeks").map((function(t){return i("th","cell").child(t)}))))),this.bodyEl)),this.selectChange=function(){}},(e=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){Me(this.value,-1),this.buildAll()}},{key:"next",value:function(){Me(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(dt("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,r=this.value,n=this.cvalue,o=this.bodyEl,l=function(t,e,r){for(var n=new Date(t,e,1,23,59,59),o=[[],[],[],[],[],[]],i=0;i<6;i+=1)for(var l=0;l<7;l+=1){var a=He(n,7*i+l),c=a.getMonth()!==e,u=a.getMonth()===r.getMonth()&&a.getDate()===r.getDate();o[i][l]={d:a,disabled:c,active:u}}return o}(r.getFullYear(),r.getMonth(),n).map((function(t){var r,n=t.map((function(t){var r="cell";return t.disabled&&(r+=" disabled"),t.active&&(r+=" active"),i("td","").child(i("div",r).on("click.stop",(function(){e.selectChange(t.d)})).child(t.d.getDate().toString()))}));return(r=i("tr","")).children.apply(r,Ie(n))}));(t=o.html("")).children.apply(t,Ie(l))}}])&&Be(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function We(t){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},We(t)}function Fe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ue(n.key),n)}}function Ue(t){var e=function(t){if("object"!=We(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=We(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==We(e)?e:e+""}var Le=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new Ne(new Date),this.el=i("div","".concat(Wt,"-datepicker")).child(this.calendar.el).hide()},(e=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(r){t(r),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&Fe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function $e(t){return $e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$e(t)}function Ve(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ye(n.key),n)}}function Ye(t){var e=function(t){if("object"!=$e(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$e(e)?e:e+""}function Xe(t,e){var r=t.target,n=r.value,o=r.selectionEnd,i="".concat(n.slice(0,o)).concat(e).concat(n.slice(o));r.value=i,r.setSelectionRange(o+1,o+1),this.inputText=i,this.textlineEl.html(i)}function qe(t){var e=t.keyCode,r=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&r&&(Xe.call(this,t,"\n"),t.stopPropagation()),13!==e||r||t.preventDefault()}function Ke(t){var e=t.target.value,r=this.suggest,n=this.textlineEl,o=this.cell;if(null!==o)if("editable"in o&&!0===o.editable||void 0===o.editable){this.inputText=e;var i=e.lastIndexOf("=");-1!==i?r.search(e.substring(i+1)):r.hide(),n.html(e),this.change("input",e)}else t.target.value=o.text||"";else{this.inputText=e;var l=e.lastIndexOf("=");-1!==l?r.search(e.substring(l+1)):r.hide(),n.html(e),this.change("input",e)}}function Ze(t){var e=this.textEl.el;setTimeout((function(){e.focus(),e.setSelectionRange(t,t)}),0)}function Je(t,e){var r=this.textEl,n=this.textlineEl;r.el.blur(),r.val(t),n.html(t),Ze.call(this,e)}function Ge(t){var e,r=this.inputText,n=r.lastIndexOf("="),o=r.substring(0,n+1),i=r.substring(n+1);i=-1!==i.indexOf(")")?i.substring(i.indexOf(")")):"",this.inputText="".concat(o+t.key,"("),e=this.inputText.length,this.inputText+=")".concat(i),Je.call(this,this.inputText,e)}function Qe(){this.suggest.setItems(this.formulas)}var tr=function(){return t=function t(e,r,n){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=r,this.rowHeight=n,this.formulas=e,this.suggest=new ke(e,(function(t){Ge.call(o,t)})),this.datepicker=new Le,this.datepicker.change((function(t){o.setText(function(t){var e=t.getMonth()+1,r=t.getDate();return e<10&&(e="0".concat(e)),r<10&&(r="0".concat(r)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(r)}(t)),o.clear()})),this.areaEl=i("div","".concat(Wt,"-editor-area")).children(this.textEl=i("textarea","").on("input",(function(t){return Ke.call(o,t)})).on("paste.stop",(function(){})).on("keydown",(function(t){return qe.call(o,t)})),this.textlineEl=i("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),this.el=i("div","".concat(Wt,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}},e=[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),Qe.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",r=this.textEl,n=this.areaEl,o=this.suggest,i=this.freeze,l=this.el;if(t){this.areaOffset=t;var a=t.left,c=t.top,u=t.width,s=t.height,f=t.l,h=t.t,y={left:0,top:0};i.w>f&&i.h>h||(i.w<f&&i.h<h?(y.left=i.w,y.top=i.h):i.w>f?y.top=i.h:i.h>h&&(y.left=i.w)),l.offset(y),n.offset({left:a-y.left-.8,top:c-y.top-.8}),r.offset({width:u-9+.8,height:s-3+.8});var p={left:0};p[e]=s,o.setOffset(p),o.hide()}}},{key:"setCell",value:function(t){if(!t||!1!==t.editable){var e=this.el;this.datepicker,this.suggest,e.show(),this.cell=t;var r=t&&t.text||"";this.setText(r)}}},{key:"setText",value:function(t){this.inputText=t,Je.call(this,t,t.length)}}],e&&Ve(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function er(t){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},er(t)}function rr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(rr=function(){return!!t})()}function nr(t){return nr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nr(t)}function or(t,e){return or=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},or(t,e)}var ir=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=nr(e),function(t,e){if(e&&("object"==er(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,rr()?Reflect.construct(e,r||[],nr(t).constructor):e.apply(t,r))}(this,e,["div","".concat(Wt,"-button ").concat(n)])).child(dt("button.".concat(t))),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&or(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(o);function lr(t){return function(t){if(Array.isArray(t))return ur(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||cr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ar(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(t,e)||cr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cr(t,e){if(t){if("string"==typeof t)return ur(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ur(t,e):void 0}}function ur(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function sr(t){return sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sr(t)}function fr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pr(n.key),n)}}function yr(t,e,r){return e&&hr(t.prototype,e),r&&hr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function pr(t){var e=function(t){if("object"!=sr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=sr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==sr(e)?e:e+""}function vr(){return window.devicePixelRatio||1}function dr(){return vr()-.5}function br(t){return parseInt(t*vr(),10)}function mr(t){var e=br(t);return e>0?e-.5:.5}var gr=function(){return yr((function t(e,r,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;fr(this,t),this.x=e,this.y=r,this.width=n,this.height=o,this.padding=i,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}),[{key:"setBorders",value:function(t){var e=t.top,r=t.bottom,n=t.left,o=t.right;e&&(this.borderTop=e),o&&(this.borderRight=o),r&&(this.borderBottom=r),n&&(this.borderLeft=n)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,r=this.padding,n=this.x;return"left"===t?n+=r:"center"===t?n+=e/2:"right"===t&&(n+=e-r),n}},{key:"texty",value:function(t,e){var r=this.height,n=this.padding,o=this.y;return"top"===t?o+=n:"middle"===t?o+=r/2-e/2:"bottom"===t&&(o+=r-n-e),o}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,r=this.width;return[[t+r,e],[t+r,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,r=this.width,n=this.height;return[[t,e+n],[t+r,e+n]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}])}();function wr(t,e,r,n,o,i,l){var a={x:0,y:0};"underline"===t?a.y="bottom"===o?0:"top"===o?-(i+2):-i/2:"strike"===t&&("bottom"===o?a.y=i/2:"top"===o&&(a.y=-(i/2+2))),"center"===n?a.x=l/2:"right"===n&&(a.x=l),this.line([e-a.x,r-a.y],[e-a.x+l,r-a.y])}var Or=function(){return yr((function t(e,r,n){fr(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(r,n),this.ctx.scale(vr(),vr())}),[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=br(t),this.el.height=br(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,r=t.height;return this.ctx.clearRect(0,0,e,r),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(br(t),br(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,r,n){return this.ctx.clearRect(t,e,r,n),this}},{key:"fillRect",value:function(t,e,r,n){return this.ctx.fillRect(br(t)-.5,br(e)-.5,br(r),br(n)),this}},{key:"fillText",value:function(t,e,r){return this.ctx.fillText(t,br(e),br(r)),this}},{key:"image",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.ctx,o=r.align,i=void 0===o?"left":o,l=r.valign,a=void 0===l?"top":l,c=r.keepAspect,u=void 0===c||c;if(n.save(),n.beginPath(),"string"==typeof t){var s=new Image;s.src=t,t=s}var f=e.innerWidth(),h=e.innerHeight(),y=t.width,p=t.height;if(u){var v=Math.min(f/t.width,h/t.height);y=t.width*v,p=t.height*v}var d=e.x+e.padding,b=e.y+e.padding;return"center"===i?d=e.x+(e.width-y)/2:"right"===i&&(d=e.x+e.width-y-e.padding),"middle"===a?b=e.y+(e.height-p)/2:"bottom"===a&&(b=e.y+e.height-p-e.padding),n.rect(mr(e.x+1),mr(e.y+1),br(e.width-2),br(e.height-2)),n.clip(),n.drawImage(t,br(d),br(b),br(y),br(p)),n.restore(),this}},{key:"text",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.ctx,l=n.align,a=n.valign,c=n.font,u=n.color,s=n.strike,f=n.underline,h=e.textx(l);i.save(),i.beginPath(),this.attr({textAlign:l,textBaseline:a,font:"".concat(c.italic?"italic":""," ").concat(c.bold?"bold":""," ").concat(br(c.size),"px ").concat(c.name),fillStyle:u,strokeStyle:u});var y="".concat(t).split("\n"),p=e.innerWidth(),v=[];y.forEach((function(t){var e=i.measureText(t).width;if(o&&e>br(p)){for(var r={w:0,len:0,start:0},n=0;n<t.length;n+=1)r.w>=br(p)&&(v.push(t.substr(r.start,r.len)),r={w:0,len:0,start:n}),r.len+=1,r.w+=i.measureText(t[n]).width+1;r.len>0&&v.push(t.substr(r.start,r.len))}else v.push(t)}));var d=(v.length-1)*(c.size+2),b=e.texty(a,d);return v.forEach((function(t){var e=i.measureText(t).width;r.fillText(t,h,b),s&&wr.call(r,"strike",h,b,l,a,c.size,e),f&&wr.call(r,"underline",h,b,l,a,c.size,e),b+=c.size+2})),i.restore(),this}},{key:"border",value:function(t,e){var r=this.ctx;return r.lineWidth=dr,r.strokeStyle=e,"medium"===t?r.lineWidth=br(2)-.5:"thick"===t?r.lineWidth=br(3):"dashed"===t?r.setLineDash([br(3),br(2)]):"dotted"===t?r.setLineDash([br(1),br(1)]):"double"===t&&r.setLineDash([br(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=ar(arguments.length<=0?void 0:arguments[0],2),r=e[0],n=e[1];t.moveTo(mr(r),mr(n));for(var o=1;o<arguments.length;o+=1){var i=ar(o<0||arguments.length<=o?void 0:arguments[o],2),l=i[0],a=i[1];t.lineTo(mr(l),mr(a))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var r=t.borderTop,n=t.borderRight,o=t.borderBottom,i=t.borderLeft;r&&(this.border.apply(this,lr(r)),this.line.apply(this,lr(t.topxys()))),n&&(this.border.apply(this,lr(n)),this.line.apply(this,lr(t.rightxys()))),o&&(this.border.apply(this,lr(o)),this.line.apply(this,lr(t.bottomxys()))),i&&(this.border.apply(this,lr(i)),this.line.apply(this,lr(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,r=t.x,n=t.y,o=r+t.width-15,i=n+t.height-15;e.save(),e.beginPath(),e.moveTo(br(o),br(i)),e.lineTo(br(o+8),br(i)),e.lineTo(br(o+4),br(i+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,r=t.x,n=t.y,o=r+t.width-1;e.save(),e.beginPath(),e.moveTo(br(o-8),br(n-1)),e.lineTo(br(o),br(n-1)),e.lineTo(br(o),br(n+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,r=t.x,n=t.y,o=r+t.width-1;e.save(),e.beginPath(),e.moveTo(br(o-8),br(n-1)),e.lineTo(br(o),br(n-1)),e.lineTo(br(o),br(n+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var r=this.ctx,n=t.x,o=t.y,i=t.width,l=t.height,a=t.bgcolor;r.save(),r.beginPath(),r.fillStyle=a||"#fff",r.rect(mr(n+1),mr(o+1),br(i-2),br(l-2)),r.clip(),r.fill(),e(),r.restore()}}])}(),Sr=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],jr=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function kr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Er(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Er(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Er(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var Pr=function(t,e){var r=kr(t,1)[0],n=t;if('"'===r)return t.substring(1);var o=1;if("-"===r&&(n=t.substring(1),o=-1),n[0]>="0"&&n[0]<="9")return o*Number(n);var i=kr(s(n),2);return o*e(i[0],i[1])},xr=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===t[0]){var o=function(t){for(var e=[],r=[],n=[],o=0,i="",l=1,a="",c=0;c<t.length;c+=1){var u=t.charAt(c);if(" "!==u){if(u>="a"&&u<="z")n.push(u.toUpperCase());else if(u>="0"&&u<="9"||u>="A"&&u<="Z"||"."===u)n.push(u);else if('"'===u){for(c+=1;'"'!==t.charAt(c);)n.push(t.charAt(c)),c+=1;r.push('"'.concat(n.join(""))),n=[]}else if("-"===u&&/[+\-*/,(]/.test(a))n.push(u);else{if("("!==u&&n.length>0&&r.push(n.join("")),")"===u){var h=e.pop();if(2===o)try{for(var y=kr(s(r.pop()),2),p=y[0],v=y[1],d=kr(s(r.pop()),2),b=d[0],m=d[1],g=0,w=b;w<=p;w+=1)for(var O=m;O<=v;O+=1)r.push(f(w,O)),g+=1;r.push([h,g])}catch(t){}else if(1===o||3===o)3===o&&r.push(i),r.push([h,l]),l=1;else for(;"("!==h&&(r.push(h),!(e.length<=0));)h=e.pop();o=0}else if("="===u||">"===u||"<"===u){var S=t.charAt(c+1);i=u,"="!==S&&"-"!==S||(i+=S,c+=1),o=3}else if(":"===u)o=2;else if(","===u)3===o&&r.push(i),o=1,l+=1;else if("("===u&&n.length>0)e.push(n.join(""));else{if(e.length>0&&("+"===u||"-"===u)){var j=e[e.length-1];if("("!==j&&r.push(e.pop()),"*"===j||"/"===j)for(;e.length>0&&"("!==(j=e[e.length-1]);)r.push(e.pop())}else if(e.length>0){var k=e[e.length-1];"*"!==k&&"/"!==k||r.push(e.pop())}e.push(u)}n=[]}a=u}}for(n.length>0&&r.push(n.join(""));e.length>0;)r.push(e.pop());return r}(t.substring(1));return o.length<=0?t:function(t,e,r,n){for(var o=[],i=0;i<t.length;i+=1){var l=t[i],a=l[0];if("+"===l){var c=o.pop();o.push(Z("+",o.pop(),c))}else if("-"===l)if(1===o.length){var u=o.pop();o.push(Z("*",u,-1))}else{var s=o.pop();o.push(Z("-",o.pop(),s))}else if("*"===l)o.push(Z("*",o.pop(),o.pop()));else if("/"===l){var f=o.pop();o.push(Z("/",o.pop(),f))}else if("="===a||">"===a||"<"===a){var h=o.pop();Number.isNaN(h)||(h=Number(h));var y=o.pop();Number.isNaN(y)||(y=Number(y));var p=!1;"="===a?p=y===h:">"===l?p=y>h:">="===l?p=y>=h:"<"===l?p=y<h:"<="===l&&(p=y<=h),o.push(p)}else if(Array.isArray(l)){for(var v=kr(l,2),d=v[0],b=v[1],m=[],g=0;g<b;g+=1)m.push(o.pop());o.push(e[d].render(m.reverse()))}else{if(n.includes(l))return 0;(a>="a"&&a<="z"||a>="A"&&a<="Z")&&n.push(l),o.push(Pr(l,r)),n.pop()}}return o[0]}(o,e,(function(t,o){return xr(r(t,o),e,r,n)}),n)}return t};const Tr={render:xr};function _r(t){return function(t){if(Array.isArray(t))return Ar(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Cr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cr(t,e){if(t){if("string"==typeof t)return Ar(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ar(t,e):void 0}}function Ar(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var Rr=[{key:"SUM",title:bt("formula.sum"),render:function(t){return t.reduce((function(t,e){return Z("+",t,e)}),0)}},{key:"AVERAGE",title:bt("formula.average"),render:function(t){return t.reduce((function(t,e){return Number(t)+Number(e)}),0)/t.length}},{key:"MAX",title:bt("formula.max"),render:function(t){return Math.max.apply(Math,_r(t.map((function(t){return Number(t)}))))}},{key:"MIN",title:bt("formula.min"),render:function(t){return Math.min.apply(Math,_r(t.map((function(t){return Number(t)}))))}},{key:"IF",title:bt("formula._if"),render:function(t){var e,r,n=(r=3,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(e,r)||Cr(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],i=n[1],l=n[2];return o?i:l}},{key:"AND",title:bt("formula.and"),render:function(t){return t.every((function(t){return t}))}},{key:"OR",title:bt("formula.or"),render:function(t){return t.some((function(t){return t}))}},{key:"CONCAT",title:bt("formula.concat"),render:function(t){return t.join("")}}],Ir=Rr,Dr={};function Br(t,e){if(t){if("string"==typeof t)return zr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zr(t,e):void 0}}function zr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Mr(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}Rr.forEach((function(t){Dr[t.key]=t}));var Hr=function(t){return t},Nr=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=function(t){if(Array.isArray(t))return t}(o=Number(t).toFixed(2).toString().split("\\."))||Mr(o)||Br(o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r=e[0],n=e.slice(1);return[r.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(function(t){return function(t){if(Array.isArray(t))return zr(t)}(t)||Mr(t)||Br(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n))}var o;return t},Wr=[{key:"normal",title:bt("format.normal"),type:"string",render:Hr},{key:"text",title:bt("format.text"),type:"string",render:Hr},{key:"number",title:bt("format.number"),type:"number",label:"1,000.12",render:Nr},{key:"percent",title:bt("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:bt("format.rmb"),type:"number",label:"￥10.00",render:function(t){return"￥".concat(Nr(t))}},{key:"usd",title:bt("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(Nr(t))}},{key:"eur",title:bt("format.eur"),type:"number",label:"€10.00",render:function(t){return"€".concat(Nr(t))}},{key:"date",title:bt("format.date"),type:"date",label:"26/09/2008",render:Hr},{key:"time",title:bt("format.time"),type:"date",label:"15:59:00",render:Hr},{key:"datetime",title:bt("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:Hr},{key:"duration",title:bt("format.duration"),type:"date",label:"24:01:00",render:Hr}],Fr={};function Ur(t){return Ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ur(t)}function Lr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function $r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vr(n.key),n)}}function Vr(t){var e=function(t){if("object"!=Ur(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ur(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ur(e)?e:e+""}Wr.forEach((function(t){Fr[t.key]=t}));var Yr={fillStyle:"#f4f5f8"},Xr={fillStyle:"#fff",lineWidth:dr,strokeStyle:"rgba(0,0,0,0.2)"};function qr(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=t.cellRect(e,r),i=o.left,l=o.top,a=o.width,c=o.height;return new gr(i,l+n,a,c,5)}function Kr(t,e,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=e.sortedRowMap,l=e.rows,a=e.cols;if(!l.isHide(r)&&!a.isHide(n)){var c=r;i.has(r)&&(c=i.get(r));var u=e.getCell(c,n);if(null!==u){var s=!1;"editable"in u&&!1===u.editable&&(s=!0);var f=e.getCellStyleOrDefault(c,n),h=qr(e,r,n,o);h.bgcolor=f.bgcolor,void 0!==f.border&&(h.setBorders(f.border),t.strokeBorders(h)),t.rect(h,(function(){try{if(u.image){if(t.image(u.image,h,{align:f.align,valign:f.valign,keepAspect:!1!==u.keepAspect}),u.text){var r=new gr(h.x,h.y+.7*h.height,h.width,.3*h.height,5);Zr(t,e,u,r,f)}return}Zr(t,e,u,h,f)}finally{s&&t.frozen(h)}}))}}}function Zr(t,e,r,n,o){var i="";i=e.settings.evalPaused?r.text||"":Tr.render(r.text||"",Dr,(function(t,r){return e.getCellTextOrDefault(r,t)})),o.format&&(i=Fr[o.format].render(i));var l=Object.assign({},o.font);l.size=function(t){for(var e=0;e<jr.length;e+=1){var r=jr[e];if(r.pt===t)return r.px}return t}(l.size),t.text(i,n,{align:o.align,valign:o.valign,font:l,color:o.color,strike:o.strike,underline:o.underline},o.textwrap),"select"===r.type&&t.dropdown(n)}function Jr(t){var e=this.data,r=this.draw;if(t){var n=e.autoFilter;if(!n.active())return;var o=n.hrange();t.intersects(o)&&o.each((function(t,n){var o=qr(e,t,n);r.dropdown(o)}))}}function Gr(t,e,r,n,o){var i=this.draw,l=this.data;i.save(),i.translate(e,r).translate(n,o);var a=l.exceptRowSet,c=l.exceptRowTotalHeight(t.sri,t.eri);i.save(),i.translate(0,-c),t.each((function(t,e){Kr(i,l,t,e)}),(function(t){return function(t){var e=a.has(t);if(e){var r=l.rows.getHeight(t);i.translate(0,-r)}return!e}(t)})),i.restore();var u=new Set;i.save(),i.translate(0,-c),l.eachMergesInView(t,(function(t){var e=t.sri,r=t.sci,n=t.eri;if(a.has(e)){if(!u.has(e)){u.add(e);var o=l.rows.sumHeight(e,n+1);i.translate(0,-o)}}else Kr(i,l,e,r)})),i.restore(),Jr.call(this,t),i.restore()}function Qr(t,e,r,n){var o=this.draw;o.save(),o.attr({fillStyle:"rgba(0, 0, 0, 0.08)"}).fillRect(t,e,r,n),o.restore()}function tn(t,e,r,n,o,i){var l=this,a=this.draw,u=this.data,s=e.h,f=e.w,h=i+n,y=o+r;a.save(),a.attr(Yr),"all"!==t&&"left"!==t||a.fillRect(0,h,r,s),"all"!==t&&"top"!==t||a.fillRect(y,0,f,n);var p=u.selector.range,v=p.sri,d=p.sci,b=p.eri,m=p.eci;a.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(br(16),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:dr(),strokeStyle:"rgba(0,0,0,0.2)"}),"all"!==t&&"left"!==t||(u.rowEach(e.sri,e.eri,(function(t,e,n){var o=h+e,i=t;a.line([0,o],[r,o]),v<=i&&i<b+1&&Qr.call(l,0,o,r,n),a.fillText(i+1,r/2,o+n/2),t>0&&u.rows.isHide(t-1)&&(a.save(),a.attr({strokeStyle:"#c6c6c6"}),a.line([5,o+5],[r-5,o+5]),a.restore())})),a.line([0,s+h],[r,s+h]),a.line([r,h],[r,s+h])),"all"!==t&&"top"!==t||(u.colEach(e.sci,e.eci,(function(t,e,r){var o=y+e,i=t;a.line([o,0],[o,n]),d<=i&&i<m+1&&Qr.call(l,o,0,r,n),a.fillText(c(i),o+r/2,n/2),t>0&&u.cols.isHide(t-1)&&(a.save(),a.attr({strokeStyle:"#c6c6c6"}),a.line([o+5,5],[o+5,n-5]),a.restore())})),a.line([f+y,0],[f+y,n]),a.line([0,n],[f+y,n])),a.restore()}function en(t,e){var r=this.draw;r.save(),r.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),r.restore()}function rn(t,e,r,n,o){var i=t.sri,l=t.sci,a=t.eri,c=t.eci,u=t.w,s=t.h,f=this.draw,h=this.data,y=h.settings;f.save(),f.attr(Xr).translate(e+n,r+o),y.showGrid?(h.rowEach(i,a,(function(t,e,r){t!==i&&f.line([0,e],[u,e]),t===a&&f.line([0,e+r],[u,e+r])})),h.colEach(l,c,(function(t,e,r){t!==l&&f.line([e,0],[e,s]),t===c&&f.line([e+r,0],[e+r,s])})),f.restore()):f.restore()}function nn(t,e,r,n){var o=this.draw,i=this.data,l=i.viewWidth()-t,a=i.viewHeight()-e;o.save().translate(t,e).attr({strokeStyle:"rgba(0,0,0, .6)"}),o.line([0,n],[l,n]),o.line([r,0],[r,a]),o.restore()}var on=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.draw=new Or(e,r.viewWidth(),r.viewHeight()),this.data=r},e=[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data,e=t.rows,r=t.cols.indexWidth,n=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var o=t.viewRange(),i=t.freezeTotalWidth(),l=t.freezeTotalHeight(),a=t.scroll,c=a.x,u=a.y;rn.call(this,o,r,n,i,l),Gr.call(this,o,r,n,-c,-u),tn.call(this,"all",o,r,n,i,l),en.call(this,r,n);var s,f,h=(s=t.freeze,f=2,function(t){if(Array.isArray(t))return t}(s)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(s,f)||function(t,e){if(t){if("string"==typeof t)return Lr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lr(t,e):void 0}}(s,f)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),y=h[0],p=h[1];if(y>0||p>0){if(y>0){var v=o.clone();v.sri=0,v.eri=y-1,v.h=l,rn.call(this,v,r,n,i,0),Gr.call(this,v,r,n,-c,0),tn.call(this,"top",v,r,n,i,0)}if(p>0){var d=o.clone();d.sci=0,d.eci=p-1,d.w=i,rn.call(this,d,r,n,0,l),tn.call(this,"left",d,r,n,0,l),Gr.call(this,d,r,n,0,-u)}var b=t.freezeViewRange();rn.call(this,b,r,n,0,0),tn.call(this,"all",b,r,n,0,0),Gr.call(this,b,r,n,0,0),nn.call(this,r,n,i,l)}}},{key:"clear",value:function(){this.draw.clear()}}],e&&$r(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();const ln=on;function an(t){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},an(t)}function cn(t){return function(t){if(Array.isArray(t))return un(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return un(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?un(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function un(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function sn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fn(n.key),n)}}function fn(t){var e=function(t){if("object"!=an(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=an(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==an(e)?e:e+""}var hn=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],yn=["landscape","portrait"];function pn(t){return parseInt(96*t,10)}function vn(t){"cancel"===t?this.el.hide():this.toPrint()}function dn(t){var e=this.paper,r=t.target.value,n=hn[r];e.w=pn(n[1]),e.h=pn(n[2]),this.preview()}function bn(t){var e=this.paper,r=t.target.value,n=yn[r];e.orientation=n,this.preview()}var mn=function(){return t=function t(e){var r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper={w:pn(hn[0][1]),h:pn(hn[0][2]),padding:50,orientation:yn[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=i("div","".concat(Wt,"-print")).children(i("div","".concat(Wt,"-print-bar")).children(i("div","-title").child("Print settings"),i("div","-right").children(i("div","".concat(Wt,"-buttons")).children(new ir("cancel").on("click",vn.bind(this,"cancel")),new ir("next","primary").on("click",vn.bind(this,"next"))))),i("div","".concat(Wt,"-print-content")).children(this.contentEl=i("div","-content"),i("div","-sider").child(i("form","").children(i("fieldset","").children(i("label","").child("".concat(dt("print.size"))),(r=i("select","")).children.apply(r,cn(hn.map((function(t,e){return i("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))})))).on("change",dn.bind(this))),i("fieldset","").children(i("label","").child("".concat(dt("print.orientation"))),(n=i("select","")).children.apply(n,cn(yn.map((function(t,e){return i("option","").attr("value",e).child("".concat(dt("print.orientations")[e]))})))).on("change",bn.bind(this))))))).hide()},(e=[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,r=this.paper,n=r.width,o=r.height,l=r.padding,a=n-2*l,c=o-2*l,u=e.contentRange(),s=parseInt(u.h/c,10)+1,f=a/u.w,h=l,y=l;f>1&&(h+=(a-u.w)/2);var p=0,v=0;this.contentEl.html(""),this.canvases=[];for(var d={sri:0,sci:0,eri:0,eci:0},b=function(){var r=0,l=0,a=i("div","".concat(Wt,"-canvas-card")),s=i("canvas","".concat(Wt,"-canvas"));t.canvases.push(s.el);var b=new Or(s.el,n,o);for(b.save(),b.translate(h,y),f<1&&b.scale(f,f);p<=u.eri;p+=1){var m=e.rows.getHeight(p);if(!((r+=m)<c)){l=-(r-m);break}for(var g=0;g<=u.eci;g+=1)Kr(b,e,p,g,v),d.eci=g}d.eri=p,b.restore(),b.save(),b.translate(h,y),f<1&&b.scale(f,f);var w=v;e.eachMergesInView(d,(function(t){var r=t.sri,n=t.sci;Kr(b,e,r,n,w)})),b.restore(),d.sri=d.eri,d.sci=d.eci,v+=l,t.contentEl.child(i("div","".concat(Wt,"-canvas-card-wraper")).child(a.child(s)))},m=0;m<s;m+=1)b();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=i("iframe","").hide().el;window.document.body.appendChild(e);var r=e.contentWindow,n=r.document,o=document.createElement("style");o.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),n.head.appendChild(o),this.canvases.forEach((function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),n.body.appendChild(e)})),r.print()}}])&&sn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function gn(t){return function(t){if(Array.isArray(t))return wn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return wn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var On=[],Sn=[];function jn(t){(t=t>>1||16)<1&&(t=16);for(var e=new ArrayBuffer(t),r=new DataView(e),n=0;n<t;n++)r.setUint8(n,255*Math.random()|0);return function(t){for(var e="",r=0;r<t.length;r++)e+=On[255&t[r]];return e}(new Uint8Array(e))}function kn(t,e,r,n){if(e!==t){var o=!1,i=Pn(e).on("click",(function(t){return o=!0})).getDispose(),l=Pn(t).on("click",(function(t){var n=t.clientX,i=t.clientY;if(n||i){var l=e.getBoundingClientRect();if(n>l.x&&i>l.y&&n<l.x+l.width&&i<l.y+l.height)o||r(t);else{if(o)return;r(t)}o=!1}})).getDispose();if(!1===n)return a;xn(e,a)}function a(){i(),l()}}function En(t){return t.isConnected||document.contains(t)}function Pn(t){var e=this;if(!t||!t.addEventListener)return{on:function(){return e},autoRelease:function(){return e},getDispose:function(){return e}};var r=[];return{on:function(e,n){return t.addEventListener(e,n),r.push((function(){t.removeEventListener(e,n)})),this},autoRelease:function(t){xn(t,this.getDispose())},getDispose:function(t){var e=function(){for(var t=0;t<r.length;t++)r[t](),delete r[t];r=null};return"function"==typeof t&&t(e),e}}}!function(){for(var t="0123456789abcdef",e="0123456789ABCDEF",r=0,n=0;n<16;n++)for(var o=0;o<16;o++,r++)On[r]=t[n]+t[o],Sn[r]=e[n]+e[o]}();var xn=function(){var t={},e=Symbol("release"),r=Symbol("callbacks");function n(){if(n.to&&clearTimeout(n.to),Object.keys(t).length)for(var e in t)t[e]()&&delete t[e];Object.keys(t).length&&(n.to=setTimeout(n,200))}return function(o){for(var i=arguments.length,l=new Array(i>1?i-1:0),a=1;a<i;a++)l[a-1]=arguments[a];if(o&&(o instanceof Node||o instanceof Attr)&&(l=l.filter((function(t){return t instanceof Function}))).length){En(o)||console.warn([o,"not in page."]);var c=t[o._uuid];if(c){var u=c[r];return u.push.apply(u,gn(l)),function(){for(var t=0;t<l.length;t++){var r=l[t];u.splice(u.indexOf(r),1)}l.length=0,u.length||(c[e]=!0)}}var s=function(){if(!En(o)){for(var t=0;t<s[r].length;t++)try{s[r][t](o),Cn(o)}catch(t){}return!0}return!!s[e]};return s[r]=gn(l),t[o._uuid]=s,1==Object.keys(t).length&&n(),function(){for(var t=s[r],n=0;n<l.length;n++){var o=l[n];t.splice(t.indexOf(o),1)}l.length=0,t.length||(s[e]=!0)}}}}(),Tn=function(){var t={},e=Symbol("release"),r=Symbol("callback");function n(){if(n.to&&clearTimeout(n.to),Object.keys(t).length)for(var e in t)t[e]()&&delete t[e];Object.keys(t).length&&(n.to=setTimeout(n,200))}return function(o){for(var i=arguments.length,l=new Array(i>1?i-1:0),a=1;a<i;a++)l[a-1]=arguments[a];if(o&&(o instanceof Node||o instanceof Attr)&&(o instanceof ShadowRoot&&(o=o.host),(l=l.filter((function(t){return t instanceof Function}))).length)){En(o)||console.warn([o,"not in page."]);var c=t[o._uuid];if(c){var u=c[r];return u.push.apply(u,gn(l)),function(){for(var t=0;t<l.length;t++){var r=l[t];u.splice(u.indexOf(r),1)}l.length=0,u.length||(c[e]=!0)}}var s,f,h,y=(s=o.offsetWidth,f=o.offsetHeight,h=jn(16),function(){return o.offsetWidth==s&&o.offsetHeight==f||(s=o.offsetWidth,f=o.offsetHeight,clearTimeout(o[h]),o[h]=setTimeout((function(){for(var t=0;t<y[r].length;t++)try{y[r][t](o)}catch(t){}}),500)),!En(o)||!!y[e]});return y[r]=gn(l),t[o._uuid]=y,1==Object.keys(t).length&&n(),function(){for(var t=y[r],n=0;n<l.length;n++){var o=l[n];t.splice(t.indexOf(o),1)}l.length=0,t.length||(y[e]=!0)}}}}(),_n=function(){var t={},e=Symbol("release"),r=Symbol("callbacks");function n(){if(n.to&&clearTimeout(n.to),Object.keys(t).length)for(var e in t)t[e]()&&delete t[e];Object.keys(t).length&&(n.to=setTimeout(n,200))}return function(o){for(var i=arguments.length,l=new Array(i>1?i-1:0),a=1;a<i;a++)l[a-1]=arguments[a];if(o&&(o instanceof Node||o instanceof Attr)&&(l=l.filter((function(t){return t instanceof Function}))).length){En(o)||console.warn([o,"not in page."]);var c=t[o._uuid];if(c){var u=c[r];return u.push.apply(u,gn(l)),function(){for(var t=0;t<l.length;t++){var r=l[t];u.splice(u.indexOf(r),1)}l.length=0,u.length||(c[e]=!0)}}var s=function(){if(!(i=((n=o).host||n).getBoundingClientRect())||!i.width&&!i.height){for(var t=0;t<s[r].length;t++)try{s[r][t](o),Cn(o)}catch(t){}return!0}var n,i;return!!s[e]};return s[r]=gn(l),t[o._uuid]=s,1==Object.keys(t).length&&n(),function(){for(var t=s[r],n=0;n<l.length;n++){var o=l[n];t.splice(t.indexOf(o),1)}l.length=0,t.length||(s[e]=!0)}}}}();function Cn(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];Array.isArray(e[0])&&(e=e[0]);for(var n=0;n<e.length;n++)for(var o=e[n],i=Object.keys(o),l=0;l<i.length;l++)delete o[i[l]]}function An(t){return An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},An(t)}function Rn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function In(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dn(n.key),n)}}function Dn(t){var e=function(t){if("object"!=An(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=An(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==An(e)?e:e+""}var Bn=[{key:"copy",title:bt("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:bt("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:bt("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:bt("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:bt("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"paste-cols-to-rows",title:bt("contextmenu.pasteColsToRows")},{key:"paste-rows-to-cols",title:bt("contextmenu.pasteRowsToCols")},{key:"divider"},{key:"insert-row",title:bt("contextmenu.insertRow")},{key:"insert-column",title:bt("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:bt("contextmenu.deleteRow")},{key:"delete-column",title:bt("contextmenu.deleteColumn")},{key:"delete-cell-text",title:bt("contextmenu.deleteCellText")},{key:"hide",title:bt("contextmenu.hide")},{key:"divider"},{key:"cell-printable",title:bt("contextmenu.cellprintable")},{key:"cell-non-printable",title:bt("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:bt("contextmenu.celleditable")},{key:"cell-non-editable",title:bt("contextmenu.cellnoneditable")}];function zn(t){var e=this;return"divider"===t.key?i("div","".concat(Wt,"-item divider")):i("div","".concat(Wt,"-item")).on("click",(function(){e.itemClick(t.key),e.hide()})).children(t.title(),i("div","label").child(t.label||""))}function Mn(){var t=this;return Bn.map((function(e){return zn.call(t,e)}))}var Hn=function(){return t=function t(e,r){var n,o,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.targetEl=e,this.menuItems=Mn.call(this),this.el=(n=i("div","".concat(Wt,"-contextmenu"))).children.apply(n,(o=this.menuItems,function(t){if(Array.isArray(t))return Rn(t)}(o)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||function(t,e){if(t){if("string"==typeof t)return Rn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rn(t,e):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).hide(),this.viewFn=r,this.itemClick=function(){},this.isHide=l,this.setMode("range")},(e=[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){this.el.hide()}},{key:"setPosition",value:function(t,e){var r=this;if(!this.isHide){var n=this.el,o=n.show().offset().width,i=this.viewFn(),l=i.height/2,a=t;i.width-t<=o&&(a-=o),n.css("left","".concat(a,"px")),e>l?n.css("bottom","".concat(i.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):n.css("top","".concat(e,"px")).css("max-height","".concat(i.height-e,"px")).css("bottom","auto"),_n(n.el,kn(this.targetEl.el,n.el,(function(){return r.hide()}),!1))}}}])&&In(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Nn(t){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nn(t)}function Wn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fn(n.key),n)}}function Fn(t){var e=function(t){if("object"!=Nn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Nn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Nn(e)?e:e+""}var Un=function(){return t=function t(e,r,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.targetEl=e,this.tip="",r&&(this.tip=dt("toolbar.".concat(r.replace(/-[a-z]/g,(function(t){return t[1].toUpperCase()}))))),n&&(this.tip+=" (".concat(n,")")),this.tag=r,this.shortcut=n,this.value=o,this.el=this.element(),this.change=function(){}},(e=[{key:"element",value:function(){var t=this,e=this.tip;return i("div","".concat(Wt,"-toolbar-btn")).on("mouseenter",(function(e){t.tip&&function(t,e,r){if(!r.classList.contains("active")){var n=r.getBoundingClientRect(),o=n.left,l=n.top,a=n.width,c=n.height,u=i("div","".concat(Wt,"-tooltip")).html(e).show();t.el.appendChild(u.el);var s=u.box(),f=t.box();u.css("left","".concat(o-f.left+a/2-s.width/2,"px")).css("top","".concat(l-f.top+c+2,"px")),zt(r,"mouseleave",(function(){t.el.contains(u.el)&&t.el.removeChild(u.el)})),zt(r,"click",(function(){t.el.contains(u.el)&&t.el.removeChild(u.el)}))}}(t.targetEl,t.tip,e.target)})).attr("data-tooltip",e)}},{key:"setState",value:function(){}}])&&Wn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Ln(t){return Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ln(t)}function $n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vn(n.key),n)}}function Vn(t){var e=function(t){if("object"!=Ln(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ln(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ln(e)?e:e+""}function Yn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Yn=function(){return!!t})()}function Xn(){return Xn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=qn(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Xn.apply(null,arguments)}function qn(t){return qn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qn(t)}function Kn(t,e){return Kn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Kn(t,e)}var Zn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=qn(e),function(t,e){if(e&&("object"==Ln(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Yn()?Reflect.construct(e,r||[],qn(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kn(t,e)}(e,t),r=e,n=[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,r=this.tag;return this.dd=this.dropdown(),this.dd.change=function(e){return t.change(r,t.getValue(e))},function(t,e,r){var n=Xn(qn(t.prototype),"element",r);return"function"==typeof n?function(t){return n.apply(r,t)}:n}(e,0,this)([]).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}],n&&$n(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Un);function Jn(t){return Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jn(t)}function Gn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qn(n.key),n)}}function Qn(t){var e=function(t){if("object"!=Jn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Jn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jn(e)?e:e+""}function to(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(to=function(){return!!t})()}function eo(t){return eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},eo(t)}function ro(t,e){return ro=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ro(t,e)}var no=function(t){function e(t,r,n,o,l){var a,c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(c=function(t,e,r){return e=eo(e),function(t,e){if(e&&("object"==Jn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,to()?Reflect.construct(e,r||[],eo(t).constructor):e.apply(t,r))}(this,e,["div","".concat(Wt,"-dropdown ").concat(l)])).targetEl=t,c.title=r,c.change=function(){},c.headerClick=function(){},"string"==typeof r?c.title=i("div","".concat(Wt,"-dropdown-title")).child(r):o&&c.title.addClass("arrow-left"),c.contentEl=i("div","".concat(Wt,"-dropdown-content")).css("width",n).hide();for(var u=arguments.length,s=new Array(u>5?u-5:0),f=5;f<u;f++)s[f-5]=arguments[f];return(a=c).setContentChildren.apply(a,s),c.headerEl=i("div","".concat(Wt,"-dropdown-header")),c.headerEl.on("click",(function(){"block"!==c.contentEl.css("display")?c.show():c.hide()})).children(c.title,o?i("div","".concat(Wt,"-icon arrow-right")).child(i("div","".concat(Wt,"-icon-img arrow-down"))):""),c.children(c.headerEl,c.contentEl),c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ro(t,e)}(e,t),r=e,n=[{key:"setContentChildren",value:function(){var t;this.contentEl.html(""),arguments.length>0&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active();var e=kn(this.targetEl.el,this.parent().el,(function(){t.hide()}),!1);_n(this.contentEl.el,e)}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide()}}],n&&Gn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(o);function oo(t){return oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oo(t)}function io(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function lo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ao(n.key),n)}}function ao(t){var e=function(t){if("object"!=oo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=oo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==oo(e)?e:e+""}function co(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(co=function(){return!!t})()}function uo(t){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},uo(t)}function so(t,e){return so=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},so(t,e)}var fo=function(t){function e(t,r,n){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var l,a=new Ae("align-".concat(n)),c=r.map((function(t){return(e="align-".concat(t),i("div","".concat(Wt,"-item")).child(new Ae(e))).on("click",(function(){o.setTitle(t),o.change(t)}));var e}));return o=function(t,e,r){return e=uo(e),function(t,e){if(e&&("object"==oo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,co()?Reflect.construct(e,r||[],uo(t).constructor):e.apply(t,r))}(this,e,[t,a,"auto",!0,"bottom-left"].concat(function(t){if(Array.isArray(t))return io(t)}(l=c)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(l)||function(t,e){if(t){if("string"==typeof t)return io(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?io(t,e):void 0}}(l)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&so(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&lo(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(no);function ho(t){return ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ho(t)}function yo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,po(n.key),n)}}function po(t){var e=function(t){if("object"!=ho(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ho(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ho(e)?e:e+""}function vo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(vo=function(){return!!t})()}function bo(t){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bo(t)}function mo(t,e){return mo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},mo(t,e)}var go=function(t){function e(t,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=bo(e),function(t,e){if(e&&("object"==ho(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,vo()?Reflect.construct(e,r||[],bo(t).constructor):e.apply(t,r))}(this,e,[t,"align","",r])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mo(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){var t=this.value;return new fo(this.targetEl,["left","center","right"],t)}}])&&yo(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Zn);function wo(t){return wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wo(t)}function Oo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,So(n.key),n)}}function So(t){var e=function(t){if("object"!=wo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=wo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==wo(e)?e:e+""}function jo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(jo=function(){return!!t})()}function ko(t){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ko(t)}function Eo(t,e){return Eo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Eo(t,e)}var Po=function(t){function e(t,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=ko(e),function(t,e){if(e&&("object"==wo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,jo()?Reflect.construct(e,r||[],ko(t).constructor):e.apply(t,r))}(this,e,[t,"valign","",r])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Eo(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){var t=this.value;return new fo(this.targetEl,["top","middle","bottom"],t)}}])&&Oo(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Zn);function xo(t){return xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xo(t)}function To(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_o(n.key),n)}}function _o(t){var e=function(t){if("object"!=xo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=xo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xo(e)?e:e+""}function Co(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Co=function(){return!!t})()}function Ao(){return Ao="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Ro(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Ao.apply(null,arguments)}function Ro(t){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ro(t)}function Io(t,e){return Io=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Io(t,e)}var Do=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Ro(e),function(t,e){if(e&&("object"==xo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Co()?Reflect.construct(e,r||[],Ro(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Io(t,e)}(e,t),r=e,n=[{key:"element",value:function(){var t=this,r=this.tag;return function(t,e,r){var n=Ao(Ro(t.prototype),"element",r);return"function"==typeof n?function(t){return n.apply(r,t)}:n}(e,0,this)([]).child(new Ae(r)).on("click",(function(){return t.click()}))}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}],n&&To(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Un);function Bo(t){return Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bo(t)}function zo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mo(n.key),n)}}function Mo(t){var e=function(t){if("object"!=Bo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Bo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Bo(e)?e:e+""}function Ho(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ho=function(){return!!t})()}function No(t){return No=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},No(t)}function Wo(t,e){return Wo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Wo(t,e)}var Fo=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=No(e),function(t,e){if(e&&("object"==Bo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ho()?Reflect.construct(e,r||[],No(t).constructor):e.apply(t,r))}(this,e,[t,"autofilter"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wo(t,e)}(e,t),r=e,(n=[{key:"setState",value:function(){}}])&&zo(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Do);function Uo(t){return Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uo(t)}function Lo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Lo=function(){return!!t})()}function $o(t){return $o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$o(t)}function Vo(t,e){return Vo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Vo(t,e)}var Yo=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=$o(e),function(t,e){if(e&&("object"==Uo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Lo()?Reflect.construct(e,r||[],$o(t).constructor):e.apply(t,r))}(this,e,[t,"font-bold","Ctrl+B"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vo(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(Do);function Xo(t){return Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xo(t)}function qo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(qo=function(){return!!t})()}function Ko(t){return Ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ko(t)}function Zo(t,e){return Zo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Zo(t,e)}var Jo=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Ko(e),function(t,e){if(e&&("object"==Xo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,qo()?Reflect.construct(e,r||[],Ko(t).constructor):e.apply(t,r))}(this,e,[t,"font-italic","Ctrl+I"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zo(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(Do);function Go(t){return Go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Go(t)}function Qo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Qo=function(){return!!t})()}function ti(t){return ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ti(t)}function ei(t,e){return ei=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ei(t,e)}var ri=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=ti(e),function(t,e){if(e&&("object"==Go(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Qo()?Reflect.construct(e,r||[],ti(t).constructor):e.apply(t,r))}(this,e,[t,"strike","Ctrl+U"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ei(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(Do);function ni(t){return ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ni(t)}function oi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(oi=function(){return!!t})()}function ii(t){return ii=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ii(t)}function li(t,e){return li=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},li(t,e)}var ai=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=ii(e),function(t,e){if(e&&("object"==ni(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,oi()?Reflect.construct(e,r||[],ii(t).constructor):e.apply(t,r))}(this,e,[t,"underline","Ctrl+U"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&li(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(Do);function ci(t){return ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ci(t)}function ui(t){return function(t){if(Array.isArray(t))return si(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return si(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?si(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function si(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function fi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yi(n.key),n)}}function hi(t,e,r){return e&&fi(t.prototype,e),r&&fi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function yi(t){var e=function(t){if("object"!=ci(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ci(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ci(e)?e:e+""}var pi=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],vi=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],di=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function bi(t){var e=this;return i("td","").child(i("div","".concat(Wt,"-color-palette-cell")).on("click.stop",(function(){return e.change(t)})).css("background-color",t))}var mi=hi((function t(){var e,r,n,o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=i("div","".concat(Wt,"-color-palette")),this.change=function(){};var l=i("table","").children((e=i("tbody","")).children.apply(e,[(r=i("tr","".concat(Wt,"-theme-color-placeholders"))).children.apply(r,ui(pi.map((function(t){return bi.call(o,t)}))))].concat(ui(vi.map((function(t){var e;return(e=i("tr","".concat(Wt,"-theme-colors"))).children.apply(e,ui(t.map((function(t){return bi.call(o,t)}))))}))),[(n=i("tr","".concat(Wt,"-standard-colors"))).children.apply(n,ui(di.map((function(t){return bi.call(o,t)}))))])));this.el.child(l)}));function gi(t){return gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gi(t)}function wi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Oi(n.key),n)}}function Oi(t){var e=function(t){if("object"!=gi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=gi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gi(e)?e:e+""}function Si(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Si=function(){return!!t})()}function ji(t){return ji=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ji(t)}function ki(t,e){return ki=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ki(t,e)}var Ei=function(t){function e(t,r,n){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=new Ae(r).css("height","16px").css("border-bottom","3px solid ".concat(n)),l=new mi;return l.change=function(t){o.setTitle(t),o.change(t)},o=function(t,e,r){return e=ji(e),function(t,e){if(e&&("object"==gi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Si()?Reflect.construct(e,r||[],ji(t).constructor):e.apply(t,r))}(this,e,[t,i,"auto",!1,"bottom-left",l.el])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ki(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&wi(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(no);function Pi(t){return Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pi(t)}function xi(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ti(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ti=function(){return!!t})()}function _i(t){return _i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_i(t)}function Ci(t,e){return Ci=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ci(t,e)}var Ai=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],Ri=function(t){function e(t,r){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o,l=new Ae("line-type"),a=0,c=Ai.map((function(t,e){return i("div","".concat(Wt,"-item state ").concat(r===t[0]?"checked":"")).on("click",(function(){c[a].toggle("checked"),c[e].toggle("checked"),a=e,n.hide(),n.change(t)})).child(i("div","".concat(Wt,"-line-type")).html(t[1]))}));return n=function(t,e,r){return e=_i(e),function(t,e){if(e&&("object"==Pi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ti()?Reflect.construct(e,r||[],_i(t).constructor):e.apply(t,r))}(this,e,[t,l,"auto",!1,"bottom-left"].concat(function(t){if(Array.isArray(t))return xi(t)}(o=c)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||function(t,e){if(t){if("string"==typeof t)return xi(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xi(t,e):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ci(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(no);function Ii(t){return Ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ii(t)}function Di(t){return function(t){if(Array.isArray(t))return zi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Bi(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bi(t,e){if(t){if("string"==typeof t)return zi(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zi(t,e):void 0}}function zi(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Mi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ni(n.key),n)}}function Hi(t,e,r){return e&&Mi(t.prototype,e),r&&Mi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ni(t){var e=function(t){if("object"!=Ii(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ii(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ii(e)?e:e+""}function Wi(){var t;return i("table","").child((t=i("tbody","")).children.apply(t,arguments))}function Fi(t){var e=this;return i("td","").child(i("div","".concat(Wt,"-border-palette-cell")).child(new Ae("border-".concat(t))).on("click",(function(){e.mode=t;var r=e.mode,n=e.style,o=e.color;e.change({mode:r,style:n,color:o})})))}var Ui=Hi((function t(e){var r,n,o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.targetEl=e,this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new Ei(e,"line-color",this.color),this.ddColor.change=function(t){o.color=t},this.ddType=new Ri(e,this.style),this.ddType.change=function(t){var e,r,n=(e=t,r=1,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(e,r)||Bi(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];o.style=n},this.el=i("div","".concat(Wt,"-border-palette"));var l=Wi(i("tr","").children(i("td","".concat(Wt,"-border-palette-left")).child(Wi((r=i("tr","")).children.apply(r,Di(["all","inside","horizontal","vertical","outside"].map((function(t){return Fi.call(o,t)})))),(n=i("tr","")).children.apply(n,Di(["left","top","right","bottom","none"].map((function(t){return Fi.call(o,t)})))))),i("td","".concat(Wt,"-border-palette-right")).children(i("div","".concat(Wt,"-toolbar-btn")).child(this.ddColor.el),i("div","".concat(Wt,"-toolbar-btn")).child(this.ddType.el))));this.el.child(l)}));function Li(t){return Li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Li(t)}function $i(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return($i=function(){return!!t})()}function Vi(t){return Vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vi(t)}function Yi(t,e){return Yi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yi(t,e)}var Xi=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Ae("border-all"),o=new Ui(t);return o.change=function(t){r.change(t),r.hide()},r=function(t,e,r){return e=Vi(e),function(t,e){if(e&&("object"==Li(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,$i()?Reflect.construct(e,r||[],Vi(t).constructor):e.apply(t,r))}(this,e,[t,n,"auto",!1,"bottom-left",o.el])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yi(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(no);function qi(t){return qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qi(t)}function Ki(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zi(n.key),n)}}function Zi(t){var e=function(t){if("object"!=qi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=qi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qi(e)?e:e+""}function Ji(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ji=function(){return!!t})()}function Gi(t){return Gi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gi(t)}function Qi(t,e){return Qi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Qi(t,e)}var tl=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Gi(e),function(t,e){if(e&&("object"==qi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ji()?Reflect.construct(e,r||[],Gi(t).constructor):e.apply(t,r))}(this,e,[t,"border"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qi(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){return new Xi(this.targetEl)}}])&&Ki(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Zn);function el(t){return el="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},el(t)}function rl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nl(n.key),n)}}function nl(t){var e=function(t){if("object"!=el(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=el(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==el(e)?e:e+""}function ol(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ol=function(){return!!t})()}function il(){return il="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ll(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},il.apply(null,arguments)}function ll(t){return ll=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ll(t)}function al(t,e){return al=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},al(t,e)}var cl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=ll(e),function(t,e){if(e&&("object"==el(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ol()?Reflect.construct(e,r||[],ll(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&al(t,e)}(e,t),r=e,n=[{key:"element",value:function(){var t=this;return function(t,e,r){var n=il(ll(t.prototype),"element",r);return"function"==typeof n?function(t){return n.apply(r,t)}:n}(e,0,this)([]).child(new Ae(this.tag)).on("click",(function(){return t.change(t.tag)}))}},{key:"setState",value:function(t){this.el.disabled(t)}}],n&&rl(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Un);function ul(t){return ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ul(t)}function sl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(sl=function(){return!!t})()}function fl(t){return fl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fl(t)}function hl(t,e){return hl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},hl(t,e)}var yl=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=fl(e),function(t,e){if(e&&("object"==ul(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,sl()?Reflect.construct(e,r||[],fl(t).constructor):e.apply(t,r))}(this,e,[t,"clearformat"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hl(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(cl);function pl(t){return pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pl(t)}function vl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dl(n.key),n)}}function dl(t){var e=function(t){if("object"!=pl(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=pl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pl(e)?e:e+""}function bl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(bl=function(){return!!t})()}function ml(t){return ml=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ml(t)}function gl(t,e){return gl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gl(t,e)}var wl=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=ml(e),function(t,e){if(e&&("object"==pl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,bl()?Reflect.construct(e,r||[],ml(t).constructor):e.apply(t,r))}(this,e,[t,"paintformat"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gl(t,e)}(e,t),r=e,(n=[{key:"setState",value:function(){}}])&&vl(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Do);function Ol(t){return Ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ol(t)}function Sl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jl(n.key),n)}}function jl(t){var e=function(t){if("object"!=Ol(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ol(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ol(e)?e:e+""}function kl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(kl=function(){return!!t})()}function El(t){return El=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},El(t)}function Pl(t,e){return Pl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pl(t,e)}var xl=function(t){function e(t,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=El(e),function(t,e){if(e&&("object"==Ol(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,kl()?Reflect.construct(e,r||[],El(t).constructor):e.apply(t,r))}(this,e,[t,"color",void 0,r])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pl(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Ei(this.targetEl,t,e)}}])&&Sl(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Zn);function Tl(t){return Tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tl(t)}function _l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cl(n.key),n)}}function Cl(t){var e=function(t){if("object"!=Tl(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Tl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Tl(e)?e:e+""}function Al(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Al=function(){return!!t})()}function Rl(t){return Rl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Rl(t)}function Il(t,e){return Il=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Il(t,e)}var Dl=function(t){function e(t,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Rl(e),function(t,e){if(e&&("object"==Tl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Al()?Reflect.construct(e,r||[],Rl(t).constructor):e.apply(t,r))}(this,e,[t,"bgcolor",void 0,r])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Il(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Ei(this.targetEl,t,e)}}])&&_l(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Zn);function Bl(t){return Bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bl(t)}function zl(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ml(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ml=function(){return!!t})()}function Hl(t){return Hl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hl(t)}function Nl(t,e){return Nl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Nl(t,e)}var Wl=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n,o=jr.map((function(t){return i("div","".concat(Wt,"-item")).on("click",(function(){r.setTitle("".concat(t.pt)),r.change(t)})).child("".concat(t.pt))}));return r=function(t,e,r){return e=Hl(e),function(t,e){if(e&&("object"==Bl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ml()?Reflect.construct(e,r||[],Hl(t).constructor):e.apply(t,r))}(this,e,[t,"10","60px",!0,"bottom-left"].concat(function(t){if(Array.isArray(t))return zl(t)}(n=o)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return zl(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zl(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nl(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(no);function Fl(t){return Fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fl(t)}function Ul(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ll(n.key),n)}}function Ll(t){var e=function(t){if("object"!=Fl(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Fl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Fl(e)?e:e+""}function $l(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return($l=function(){return!!t})()}function Vl(t){return Vl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vl(t)}function Yl(t,e){return Yl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yl(t,e)}var Xl=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Vl(e),function(t,e){if(e&&("object"==Fl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,$l()?Reflect.construct(e,r||[],Vl(t).constructor):e.apply(t,r))}(this,e,[t,"font-size"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yl(t,e)}(e,t),r=e,(n=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new Wl(this.targetEl)}}])&&Ul(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Zn);function ql(t){return ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ql(t)}function Kl(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Zl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Zl=function(){return!!t})()}function Jl(t){return Jl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jl(t)}function Gl(t,e){return Gl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Gl(t,e)}var Ql=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n,o=Sr.map((function(t){return i("div","".concat(Wt,"-item")).on("click",(function(){r.setTitle(t.title),r.change(t)})).child(t.title)}));return r=function(t,e,r){return e=Jl(e),function(t,e){if(e&&("object"==ql(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Zl()?Reflect.construct(e,r||[],Jl(t).constructor):e.apply(t,r))}(this,e,[t,Sr[0].title,"160px",!0,"bottom-left"].concat(function(t){if(Array.isArray(t))return Kl(t)}(n=o)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return Kl(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kl(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gl(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(no);function ta(t){return ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ta(t)}function ea(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ra(n.key),n)}}function ra(t){var e=function(t){if("object"!=ta(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ta(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ta(e)?e:e+""}function na(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(na=function(){return!!t})()}function oa(t){return oa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},oa(t)}function ia(t,e){return ia=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ia(t,e)}var la=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=oa(e),function(t,e){if(e&&("object"==ta(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,na()?Reflect.construct(e,r||[],oa(t).constructor):e.apply(t,r))}(this,e,[t,"font-name"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ia(t,e)}(e,t),r=e,(n=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Ql(this.targetEl)}}])&&ea(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Zn);function aa(t){return aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aa(t)}function ca(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ua(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sa(n.key),n)}}function sa(t){var e=function(t){if("object"!=aa(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=aa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==aa(e)?e:e+""}function fa(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(fa=function(){return!!t})()}function ha(t){return ha=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ha(t)}function ya(t,e){return ya=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ya(t,e)}var pa=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n,o=Wr.slice(0);return o.splice(2,0,{key:"divider"}),o.splice(8,0,{key:"divider"}),o=o.map((function(t){var e=i("div","".concat(Wt,"-item"));return"divider"===t.key?e.addClass("divider"):(e.child(t.title()).on("click",(function(){r.setTitle(t.title()),r.change(t)})),t.label&&e.child(i("div","label").html(t.label))),e})),r=function(t,e,r){return e=ha(e),function(t,e){if(e&&("object"==aa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,fa()?Reflect.construct(e,r||[],ha(t).constructor):e.apply(t,r))}(this,e,[t,"Normal","220px",!0,"bottom-left"].concat(function(t){if(Array.isArray(t))return ca(t)}(n=o)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return ca(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ca(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ya(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){for(var e=0;e<Wr.length;e+=1)Wr[e].key===t&&this.title.html(Wr[e].title());this.hide()}}])&&ua(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(no);function va(t){return va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},va(t)}function da(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ba(n.key),n)}}function ba(t){var e=function(t){if("object"!=va(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=va(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==va(e)?e:e+""}function ma(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ma=function(){return!!t})()}function ga(t){return ga=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ga(t)}function wa(t,e){return wa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},wa(t,e)}var Oa=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=ga(e),function(t,e){if(e&&("object"==va(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ma()?Reflect.construct(e,r||[],ga(t).constructor):e.apply(t,r))}(this,e,[t,"format"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wa(t,e)}(e,t),r=e,(n=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new pa(this.targetEl)}}])&&da(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Zn);function Sa(t){return Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sa(t)}function ja(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ka(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ka=function(){return!!t})()}function Ea(t){return Ea=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ea(t)}function Pa(t,e){return Pa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pa(t,e)}var xa=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n,o=Rr.map((function(t){return i("div","".concat(Wt,"-item")).on("click",(function(){r.hide(),r.change(t)})).child(t.key)}));return r=function(t,e,r){return e=Ea(e),function(t,e){if(e&&("object"==Sa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ka()?Reflect.construct(e,r||[],Ea(t).constructor):e.apply(t,r))}(this,e,[t,new Ae("formula"),"180px",!0,"bottom-left"].concat(function(t){if(Array.isArray(t))return ja(t)}(n=o)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return ja(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ja(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pa(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(no);function Ta(t){return Ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ta(t)}function _a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ca(n.key),n)}}function Ca(t){var e=function(t){if("object"!=Ta(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ta(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ta(e)?e:e+""}function Aa(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Aa=function(){return!!t})()}function Ra(t){return Ra=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ra(t)}function Ia(t,e){return Ia=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ia(t,e)}var Da=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Ra(e),function(t,e){if(e&&("object"==Ta(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Aa()?Reflect.construct(e,r||[],Ra(t).constructor):e.apply(t,r))}(this,e,[t,"formula"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ia(t,e)}(e,t),r=e,(n=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new xa(this.targetEl)}}])&&_a(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Zn);function Ba(t){return Ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ba(t)}function za(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(za=function(){return!!t})()}function Ma(t){return Ma=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ma(t)}function Ha(t,e){return Ha=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ha(t,e)}var Na=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Ma(e),function(t,e){if(e&&("object"==Ba(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,za()?Reflect.construct(e,r||[],Ma(t).constructor):e.apply(t,r))}(this,e,[t,"freeze"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ha(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(Do);function Wa(t){return Wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wa(t)}function Fa(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ua(n.key),n)}}function Ua(t){var e=function(t){if("object"!=Wa(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Wa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Wa(e)?e:e+""}function La(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(La=function(){return!!t})()}function $a(t){return $a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$a(t)}function Va(t,e){return Va=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Va(t,e)}var Ya=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=$a(e),function(t,e){if(e&&("object"==Wa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,La()?Reflect.construct(e,r||[],$a(t).constructor):e.apply(t,r))}(this,e,[t,"merge"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Va(t,e)}(e,t),r=e,(n=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&Fa(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Do);function Xa(t){return Xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xa(t)}function qa(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(qa=function(){return!!t})()}function Ka(t){return Ka=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ka(t)}function Za(t,e){return Za=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Za(t,e)}var Ja=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Ka(e),function(t,e){if(e&&("object"==Xa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,qa()?Reflect.construct(e,r||[],Ka(t).constructor):e.apply(t,r))}(this,e,[t,"redo","Ctrl+Y"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Za(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(cl);function Ga(t){return Ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ga(t)}function Qa(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Qa=function(){return!!t})()}function tc(t){return tc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tc(t)}function ec(t,e){return ec=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ec(t,e)}var rc=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=tc(e),function(t,e){if(e&&("object"==Ga(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Qa()?Reflect.construct(e,r||[],tc(t).constructor):e.apply(t,r))}(this,e,[t,"undo","Ctrl+Z"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ec(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(cl);function nc(t){return nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nc(t)}function oc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(oc=function(){return!!t})()}function ic(t){return ic=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ic(t)}function lc(t,e){return lc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lc(t,e)}var ac=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=ic(e),function(t,e){if(e&&("object"==nc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,oc()?Reflect.construct(e,r||[],ic(t).constructor):e.apply(t,r))}(this,e,[t,"print","Ctrl+P"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lc(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(cl);function cc(t){return cc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cc(t)}function uc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(uc=function(){return!!t})()}function sc(t){return sc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sc(t)}function fc(t,e){return fc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},fc(t,e)}var hc=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=sc(e),function(t,e){if(e&&("object"==cc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,uc()?Reflect.construct(e,r||[],sc(t).constructor):e.apply(t,r))}(this,e,[t,"textwrap"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fc(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(Do);function yc(t){return yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yc(t)}function pc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dc(n.key),n)}}function vc(t,e,r){return e&&pc(t.prototype,e),r&&pc(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dc(t){var e=function(t){if("object"!=yc(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=yc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==yc(e)?e:e+""}function bc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mc(t,e,r){return e=wc(e),function(t,e){if(e&&("object"==yc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,gc()?Reflect.construct(e,r||[],wc(t).constructor):e.apply(t,r))}function gc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(gc=function(){return!!t})()}function wc(t){return wc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wc(t)}function Oc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sc(t,e)}function Sc(t,e){return Sc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Sc(t,e)}var jc=function(t){function e(t){var r;bc(this,e);var n=new Ae("ellipsis"),o=i("div","".concat(Wt,"-toolbar-more"));return(r=mc(this,e,[t,n,"auto",!1,"bottom-right",o])).moreBtns=o,r.contentEl.css("max-width","420px"),r}return Oc(e,t),vc(e)}(no),kc=function(t){function e(t){var r;return bc(this,e),(r=mc(this,e,[t,"more"])).el.hide(),r}return Oc(e,t),vc(e,[{key:"dropdown",value:function(){return new jc(this.targetEl)}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])}(Zn);function Ec(t){return Ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ec(t)}function Pc(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Pc=function(){return!!t})()}function xc(t){return xc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xc(t)}function Tc(t,e){return Tc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Tc(t,e)}var _c=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=xc(e),function(t,e){if(e&&("object"==Ec(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Pc()?Reflect.construct(e,r||[],xc(t).constructor):e.apply(t,r))}(this,e,[t,"sharp"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tc(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(cl);function Cc(t){return Cc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cc(t)}function Ac(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rc(n.key),n)}}function Rc(t){var e=function(t){if("object"!=Cc(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Cc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Cc(e)?e:e+""}function Ic(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Dc(){return i("div","".concat(Wt,"-toolbar-divider"))}function Bc(){var t=this;this.btns2=[],this.items.forEach((function(e){if(Array.isArray(e))e.forEach((function(e){var r=e.el,n=r.box(),o=r.computedStyle(),i=o.marginLeft,l=o.marginRight;t.btns2.push([r,n.width+parseInt(i,10)+parseInt(l,10)])}));else{var r=e.box(),n=e.computedStyle(),o=n.marginLeft,i=n.marginRight;t.btns2.push([e,r.width+parseInt(o,10)+parseInt(i,10)])}}))}function zc(){var t,e,r=this.el,n=this.btns,o=this.moreEl,i=this.btns2,l=o.dd,a=l.moreBtns,c=l.contentEl,u=r.box(),s=160,f=12,h=[],y=[];i.forEach((function(t,e){var r,n,o=(n=2,function(t){if(Array.isArray(t))return t}(r=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(r,n)||function(t,e){if(t){if("string"==typeof t)return Ic(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ic(t,e):void 0}}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=o[0],a=o[1];s+=a,e===i.length-1||s<u.width?h.push(l):(f+=a,y.push(l))})),(t=n.html("")).children.apply(t,h),(e=a.html("")).children.apply(e,y),c.css("width","".concat(f,"px")),y.length>0?o.show():o.hide()}function Mc(t){var e=this,r=new Un(this.targetEl);r.el.on("click",(function(){t.onClick&&t.onClick(e.data.getData(),e.data)})),r.tip=t.tip||"";var n=t.el;if(t.icon&&(n=i("img").attr("src",t.icon)),n){var o=i("div","".concat(Wt,"-icon"));o.child(n),r.el.child(o)}return r}var Hc=function(){return t=function t(e,r){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.targetEl=e,this.data=r,this.change=function(){},this.isHide=o;var l=r.defaultStyle();this.items=[[this.undoEl=new rc(this.targetEl),this.redoEl=new Ja(this.targetEl),new ac(this.targetEl),this.paintformatEl=new wl(this.targetEl),this.clearformatEl=new yl(this.targetEl)],Dc(),[this.formatEl=new Oa(this.targetEl)],Dc(),[this.fontEl=new la(this.targetEl),this.fontSizeEl=new Xl(this.targetEl)],Dc(),[this.boldEl=new Yo(this.targetEl),this.italicEl=new Jo(this.targetEl),this.underlineEl=new ai(this.targetEl),this.strikeEl=new ri(this.targetEl),this.textColorEl=new xl(this.targetEl,l.color)],Dc(),[this.fillColorEl=new Dl(this.targetEl,l.bgcolor),this.borderEl=new tl(this.targetEl),this.mergeEl=new Ya(this.targetEl)],Dc(),[this.alignEl=new go(this.targetEl,l.align),this.valignEl=new Po(this.targetEl,l.valign),this.textwrapEl=new hc(this.targetEl)],Dc(),[this.freezeEl=new Na(this.targetEl),this.autofilterEl=new Fo(this.targetEl),this.formulaEl=new Da(this.targetEl),this.sharpEl=new _c(this.targetEl)]];var a=r.settings.extendToolbar,c=void 0===a?{}:a;if(c.left&&c.left.length>0){this.items.unshift(Dc());var u=c.left.map(Mc.bind(this));this.items.unshift(u)}if(c.right&&c.right.length>0){this.items.push(Dc());var s=c.right.map(Mc.bind(this));this.items.push(s)}this.items.push([this.moreEl=new kc(this.targetEl)]),this.el=i("div","".concat(Wt,"-toolbar")),this.btns=i("div","".concat(Wt,"-toolbar-btns")),this.items.forEach((function(t){Array.isArray(t)?t.forEach((function(t){n.btns.child(t.el),t.change=function(){n.change.apply(n,arguments)}})):n.btns.child(t.el)})),this.el.child(this.btns),o?this.el.hide():(this.reset(),setTimeout((function(){Bc.call(n),zc.call(n),xn(n.targetEl.el,Tn(n.targetEl.el,(function(){zc.call(n)})))}),0))},(e=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var r=e.font,n=e.format;this.formatEl.setState(n),this.fontEl.setState(r.name),this.fontSizeEl.setState(r.size),this.boldEl.setState(r.bold),this.italicEl.setState(r.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}])&&Ac(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Nc(t){return Nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nc(t)}function Wc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fc(n.key),n)}}function Fc(t){var e=function(t){if("object"!=Nc(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Nc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Nc(e)?e:e+""}function Uc(t){return i("div","".concat(Wt,"-item ").concat(t))}function Lc(t){var e=this;return Uc("state").child(dt("sort.".concat(t))).on("click.stop",(function(){return e.itemClick(t)}))}function $c(t){var e=this,r=this.filterbEl,n=this.filterValues;r.html(""),Object.keys(t).forEach((function(o,l){var a=t[o],c=n.includes(o)?"checked":"";r.child(i("div","".concat(Wt,"-item state ").concat(c)).on("click.stop",(function(){return e.filterClick(l,o)})).children(""===o?dt("filter.empty"):o,i("div","label").html("(".concat(a,")"))))}))}function Vc(){var t=this.filterhEl,e=this.filterValues,r=this.values;t.html("".concat(e.length," / ").concat(r.length)),t.checked(e.length===r.length)}var Yc=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.targetEl=e,this.filterbEl=i("div","".concat(Wt,"-body")),this.filterhEl=i("div","".concat(Wt,"-header state")).on("click.stop",(function(){return r.filterClick(0,"all")})),this.el=i("div","".concat(Wt,"-sort-filter")).children(this.sortAscEl=Lc.call(this,"asc"),this.sortDescEl=Lc.call(this,"desc"),Uc("divider"),i("div","".concat(Wt,"-filter")).children(this.filterhEl,this.filterbEl),i("div","".concat(Wt,"-buttons")).children(new ir("cancel").on("click",(function(){return r.btnClick("cancel")})),new ir("ok","primary").on("click",(function(){return r.btnClick("ok")})))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]},(e=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,r=this.sort,n=this.filterValues;this.ok&&this.ok(e,r,"in",n)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,r=this.sortDescEl;e.checked("asc"===t),r.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var r=this.filterbEl,n=this.filterValues,o=this.values,l=r.children();"all"===e?l.length===n.length?(this.filterValues=[],l.forEach((function(t){return i(t).checked(!1)}))):(this.filterValues=Array.from(o),l.forEach((function(t){return i(t).checked(!0)}))):i(l[t]).toggle("checked")?n.push(e):n.splice(n.findIndex((function(t){return t===e})),1),Vc.call(this)}},{key:"set",value:function(t,e,r,n){this.ci=t;var o=this.sortAscEl,i=this.sortDescEl;null!==n?(this.sort=n.order,o.checked(n.asc()),i.checked(n.desc())):(this.sortDesc=null,o.checked(!1),i.checked(!1)),this.values=Object.keys(e),this.filterValues=r?Array.from(r.value):Object.keys(e),$c.call(this,e,r),Vc.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var r=1,n=kn(this.targetEl.el,this.el.el,(function(){r<=0&&e.hide(),r-=1}),!1);_n(this.el.el,n)}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&Wc(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Xc(t,e,r){var n=i("div","".concat(Wt,"-toast")),o=i("div","".concat(Wt,"-dimmer active"));n.children(i("div","".concat(Wt,"-toast-header")).children(new Ae("close").on("click.stop",(function(){return t.el.removeChild(n.el),void t.el.removeChild(o.el)})),e),i("div","".concat(Wt,"-toast-content")).html(r)),t.el.appendChild(n.el),t.el.appendChild(o.el);var l=n.box(),a=l.width,c=l.height,u=document.documentElement,s=u.clientHeight,f=u.clientWidth;n.offset({left:(f-a)/2,top:(s-c)/3})}function qc(t){return qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qc(t)}function Kc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zc(n.key),n)}}function Zc(t){var e=function(t){if("object"!=qc(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=qc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qc(e)?e:e+""}function Jc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Gc(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gc(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gc(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Qc(t,e){var r,n=this;return function(){for(var o=n,i=arguments.length,l=new Array(i),a=0;a<i;a++)l[a]=arguments[a];var c=l;r||(r=setTimeout((function(){r=null,t.apply(o,c)}),e))}}function tu(){var t=this.data,e=this.verticalScrollbar,r=this.horizontalScrollbar,n=t.getSelectedRect(),o=n.l,i=n.t,l=n.left,a=n.top,c=n.width,u=n.height,s=this.getTableOffset();if(Math.abs(l)+c>s.width)r.move({left:o+c-s.width});else{var f=t.freezeTotalWidth();l<f&&r.move({left:o-1-f})}if(Math.abs(a)+u>s.height)e.move({top:i+u-s.height-1});else{var h=t.freezeTotalHeight();a<h&&e.move({top:i-1-h})}}function eu(t,e,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==r){var i=this.table,l=this.selector,a=this.toolbar,c=this.data,u=this.contextMenu,s=c.getCell(e,r);t?(l.setEnd(e,r,o),this.trigger("cells-selected",s,l.range)):(l.set(e,r,n),this.trigger("cell-selected",s,e,r)),u.setMode(-1===e||-1===r?"row-col":"range"),a.reset(),i.render()}}function ru(t,e){var r=this.selector,n=this.data,o=n.rows,i=n.cols,l=Jc(r.indexes,2),a=l[0],c=l[1],u=r.range,s=u.eri,f=u.eci;if(t){var h=Jc(r.moveIndexes,2);a=h[0],c=h[1]}"left"===e?c>0&&(c-=1):"right"===e?(f!==c&&(c=f),c<i.len-1&&(c+=1)):"up"===e?a>0&&(a-=1):"down"===e?(s!==a&&(a=s),a<o.len-1&&(a+=1)):"row-first"===e?c=0:"row-last"===e?c=i.len-1:"col-first"===e?a=0:"col-last"===e&&(a=o.len-1),t&&(r.moveIndexes=[a,c]),eu.call(this,t,a,c),tu.call(this)}function nu(t){if(0===t.buttons&&t.target.className!=="".concat(Wt,"-resizer-hover")){var e=t.offsetX,r=t.offsetY,n=this.rowResizer,o=this.colResizer,i=this.tableEl,l=this.data,a=l.rows,c=l.cols;if(e>c.indexWidth&&r>a.height)return n.hide(),void o.hide();var u=i.box(),s=l.getCellRectByXY(t.offsetX,t.offsetY);s.ri>=0&&-1===s.ci?(s.width=c.indexWidth,n.show(s,{width:u.width}),a.isHide(s.ri-1)?n.showUnhide(s.ri):n.hideUnhide()):n.hide(),-1===s.ri&&s.ci>=0?(s.height=a.height,o.show(s,{height:u.height}),c.isHide(s.ci-1)?o.showUnhide(s.ci):o.hideUnhide()):o.hide()}}function ou(t){var e=this.verticalScrollbar,r=this.horizontalScrollbar,n=this.data,o=e.scroll().top,i=r.scroll().left,l=n.rows,a=n.cols,c=t.deltaY,u=t.deltaX,s=function(t,e){var r=t,n=0;do{n=e(r),r+=1}while(n<=0);return n},f=function(t){if(t>0){var r=n.scroll.ri+1;if(r<l.len){var i=s(r,(function(t){return l.getHeight(t)}));e.move({top:o+i-1})}}else{var a=n.scroll.ri-1;if(a>=0){var c=s(a,(function(t){return l.getHeight(t)}));e.move({top:0===a?0:o-c})}}},h=Math.abs(c),y=Math.abs(u),p=Math.max(h,y);/Firefox/i.test(window.navigator.userAgent)&&Qc(f(t.detail),50),p===y&&Qc(function(t){if(t>0){var e=n.scroll.ci+1;if(e<a.len){var o=s(e,(function(t){return a.getWidth(t)}));r.move({left:i+o-1})}}else{var l=n.scroll.ci-1;if(l>=0){var c=s(l,(function(t){return a.getWidth(t)}));r.move({left:0===l?0:i-c})}}}(u),50),p===h&&Qc(f(c),50)}function iu(t,e){var r=this.verticalScrollbar,n=this.horizontalScrollbar,o=r.scroll().top,i=n.scroll().left;"left"===t||"right"===t?n.move({left:i-e}):"up"!==t&&"down"!==t||r.move({top:o-e})}function lu(){var t=this.data,e=this.verticalScrollbar,r=this.getTableOffset().height,n=t.exceptRowTotalHeight(0,-1);e.set(r,t.rows.totalHeight()-n)}function au(){var t=this.data,e=this.horizontalScrollbar,r=this.getTableOffset().width;t&&e.set(r,t.cols.totalWidth())}function cu(){var t=this.selector,e=this.data,r=this.editor,n=Jc(e.freeze,2),o=n[0],i=n[1];if(o>0||i>0){var l=e.freezeTotalWidth(),a=e.freezeTotalHeight();r.setFreezeLengths(l,a)}t.resetAreaOffset()}function uu(){var t=this.tableEl,e=this.overlayerEl,r=this.overlayerCEl,n=this.table,o=this.toolbar,i=this.selector,l=this.el,a=this.getTableOffset(),c=this.getRect();t.attr(c),e.offset(c),r.offset(a),l.css("width","".concat(c.width,"px")),lu.call(this),au.call(this),cu.call(this),n.render(),o.reset(),i.reset()}function su(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function fu(t){var e=this.data,r=this.selector;"read"!==e.settings.mode&&(e.copy(),e.copyToSystemClipboard(t),r.showClipboard())}function hu(){var t=this.data,e=this.selector;"read"!==t.settings.mode&&(t.cut(),e.showClipboard())}function yu(t,e){var r=this,n=this.data;if("read"!==n.settings.mode)if(n.clipboard.isClear())n.pasteFromSystemClipboard((function(){return uu.call(r)}),(function(t){r.trigger("pasted-clipboard",t)}),t);else if(n.paste(t,(function(t){return Xc(r.targetEl,"Tip",t)})))uu.call(this);else if(e){var o=e.clipboardData.getData("text/plain");this.data.pasteFromText(o),uu.call(this)}}function pu(){this.data.hideRowsOrCols(),uu.call(this)}function vu(t,e){this.data.unhideRowsOrCols(t,e),uu.call(this)}function du(){this.data.autofilter(),uu.call(this)}function bu(){var t=this.toolbar;t.paintformatActive()&&(yu.call(this,"format"),su.call(this),t.paintformatToggle())}function mu(t){var e=this,r=this.selector,n=this.data,o=this.table,i=this.sortFilter,l=t.offsetX,a=t.offsetY,c=t.target.className==="".concat(Wt,"-selector-corner"),u=n.getCellRectByXY(l,a),s=u.left,f=u.top,h=u.width,y=u.height,p=u.ri,v=u.ci,d=n.autoFilter;if(d.includes(p,v)&&s+h-20<l&&f+y-20<a){var b=d.items(v,(function(t,e){return n.rows.getCell(t,e)}));return i.hide(),i.set(v,b,d.getFilter(v),d.getSort(v)),void i.setOffset({left:s,top:f+y+2})}if(!t.shiftKey){if(c)r.showAutofill(p,v);else{eu.call(this,!1,p,v);var m=n.getCell(p,v);if("select"===(null==m?void 0:m.type)&&s+h-20<l&&f+y-20<a)return void this.trigger("select",m,p,v,(function(t){m.text=t,o.render()}))}Ht(this.targetEl.el,(function(t){var o=n.getCellRectByXY(t.offsetX,t.offsetY);p=o.ri,v=o.ci,c?r.showAutofill(p,v):1!==t.buttons||t.shiftKey||eu.call(e,!0,p,v,!0,!0)}),(function(){c&&r.arange&&"read"!==n.settings.mode&&n.autofill(r.arange,"all",(function(t){return Xc(e.targetEl,"Tip",t)}))&&o.render(),r.hideAutofill(),bu.call(e)}))}c||1!==t.buttons||t.shiftKey&&eu.call(this,!0,p,v)}function gu(){var t=this.editor,e=this.data.getSelectedRect(),r=this.getTableOffset(),n="top";e.top>r.height/2&&(n="bottom"),t.setOffset(e,n)}function wu(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(gu.call(this),t.setCell(e.getSelectedCell()),su.call(this))}function Ou(t){var e=this,r=this.data,n=this.table,o=this.selector;r.scrolly(t,(function(){o.resetBRLAreaOffset(),gu.call(e),n.render()}))}function Su(t){var e=this,r=this.data,n=this.table,o=this.selector;r.scrollx(t,(function(){o.resetBRTAreaOffset(),gu.call(e),n.render()}))}function ju(t,e){var r=t.ri,n=this.table,o=this.selector,i=this.data,l=o.range,a=l.sri,c=l.eri;if(r>=a&&r<=c)for(var u=a;u<=c;u+=1)i.rows.setHeight(u,e);else i.rows.setHeight(r,e);n.render(),o.resetAreaOffset(),lu.call(this),gu.call(this)}function ku(t,e){var r=t.ci,n=this.table,o=this.selector,i=this.data,l=o.range,a=l.sci,c=l.eci;if(r>=a&&r<=c)for(var u=a;u<=c;u+=1)i.cols.setWidth(u,e);else i.cols.setWidth(r,e);n.render(),o.resetAreaOffset(),au.call(this),gu.call(this)}function Eu(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",r=this.data,n=this.table;if("read"!==r.settings.mode){r.setSelectedCellText(t,e);var o=r.selector,i=o.ri,l=o.ci;"finished"===e?n.render():this.trigger("cell-edited",t,i,l)}}function Pu(t){var e=this.data;"read"!==e.settings.mode&&("insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),su.call(this),uu.call(this))}function xu(t,e){var r=this.data;if("undo"!==t)if("redo"!==t)if("print"!==t)if("paintformat"!==t)if("clearformat"!==t){if("link"!==t&&"chart"!==t)if("sharp"!==t)if("autofilter"!==t)if("freeze"!==t)r.setSelectedCellAttr(t,e),"formula"!==t||r.selector.multiple()||wu.call(this),uu.call(this);else{if(e){var n=r.selector,o=n.ri,i=n.ci;return void this.freeze(o,i)}this.freeze(0,0)}else du.call(this);else{var l=this.table,a=r.getCells(r.selector);this.trigger("sharp",a,(function(){l.render()}))}}else Pu.call(this,"delete-cell-format");else!0===e?fu.call(this):su.call(this);else this.print.preview();else this.redo();else this.undo()}function Tu(t,e,r,n){this.data.setAutoFilter(t,e,r,n),uu.call(this)}function _u(){var t,e,r,n,o,i,l=this,a=[],c=this.selector,u=this.overlayerEl,s=this.rowResizer,f=this.colResizer,h=this.verticalScrollbar,y=this.horizontalScrollbar,p=this.editor,v=this.contextMenu,d=this.toolbar,b=this.sortFilter;u.on("mousemove",(function(t){nu.call(l,t)})).on("mousedown",(function(t){p.clear(),v.hide(),2===t.buttons?(l.data.xyInSelectedRect(t.offsetX,t.offsetY)||mu.call(l,t),v.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):2===t.detail?wu.call(l):mu.call(l,t)})).on("mousewheel.stop",(function(t){ou.call(l,t)})).on("mouseout",(function(t){var e=t.offsetX;t.offsetY<=0&&f.hide(),e<=0&&s.hide()})),c.inputChange=function(t){Eu.call(l,t,"input"),wu.call(l)},t=u.el,r=(e={move:function(t,e){iu.call(l,t,e)}}).move,n=e.end,o=0,i=0,zt(t,"touchstart",(function(t){var e=t.touches[0],r=e.pageX,n=e.pageY;o=r,i=n})),zt(t,"touchmove",(function(t){if(r){var e=t.changedTouches[0],n=e.pageX,l=e.pageY,a=n-o,c=l-i;(Math.abs(a)>10||Math.abs(c)>10)&&(Nt(a,c,t,r),o=n,i=l),t.preventDefault()}})),zt(t,"touchend",(function(t){if(n){var e=t.changedTouches[0],r=e.pageX,l=e.pageY;Nt(r-o,l-i,t,n)}})),d.change=function(t,e){return xu.call(l,t,e)},b.ok=function(t,e,r,n){return Tu.call(l,t,e,r,n)},s.finishedFn=function(t,e){ju.call(l,t,e)},f.finishedFn=function(t,e){ku.call(l,t,e)},s.unhideFn=function(t){vu.call(l,"row",t)},f.unhideFn=function(t){vu.call(l,"col",t)},h.moveFn=function(t,e){Ou.call(l,t,e)},y.moveFn=function(t,e){Su.call(l,t,e)},p.change=function(t,e){Eu.call(l,e,t)},v.itemClick=function(t){"copy"===t?fu.call(l):"cut"===t?hu.call(l):"paste"===t?yu.call(l,"all"):"paste-value"===t?yu.call(l,"text"):"paste-format"===t?yu.call(l,"format"):"paste-cols-to-rows"===t?yu.call(l,"colsToRows"):"paste-rows-to-cols"===t?yu.call(l,"rowsToCols"):"hide"===t?pu.call(l):Pu.call(l,t)},a.push(Tn(this.targetEl.el,(function(){l.reload()}))),Pn(u.el).on("click",(function(t){return l.focusing=!0})).getDispose((function(t){return a.push(t)})),a.push(kn(this.targetEl.el,u.el,(function(t){return l.focusing=!1}),!1)),Pn(window).on("paste",(function(t){l.focusing&&(yu.call(l,"all",t),t.preventDefault())})).on("copy",(function(t){l.focusing&&(fu.call(l,t),t.preventDefault())})).on("keydown",(function(t){if(l.focusing){var e=t.keyCode||t.which,r=t.key,n=t.ctrlKey,o=t.shiftKey,i=t.metaKey;if(n||i)switch(e){case 90:l.undo(),t.preventDefault();break;case 89:l.redo(),t.preventDefault();break;case 67:case 86:default:break;case 88:hu.call(l),t.preventDefault();break;case 85:d.trigger("underline"),t.preventDefault();break;case 37:ru.call(l,o,"row-first"),t.preventDefault();break;case 38:ru.call(l,o,"col-first"),t.preventDefault();break;case 39:ru.call(l,o,"row-last"),t.preventDefault();break;case 40:ru.call(l,o,"col-last"),t.preventDefault();break;case 32:eu.call(l,!1,-1,l.data.selector.ci,!1),t.preventDefault();break;case 66:d.trigger("bold");break;case 73:d.trigger("italic")}else{switch(e){case 32:o&&eu.call(l,!1,l.data.selector.ri,-1,!1);break;case 27:v.hide(),su.call(l);break;case 37:ru.call(l,o,"left"),t.preventDefault();break;case 38:ru.call(l,o,"up"),t.preventDefault();break;case 39:ru.call(l,o,"right"),t.preventDefault();break;case 40:ru.call(l,o,"down"),t.preventDefault();break;case 9:p.clear(),ru.call(l,!1,o?"left":"right"),t.preventDefault();break;case 13:p.clear(),ru.call(l,!1,o?"up":"down"),t.preventDefault();break;case 8:Pu.call(l,"delete-cell-text"),t.preventDefault()}"Delete"===r?(Pu.call(l,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(Eu.call(l,t.key,"input"),wu.call(l)):113===e&&wu.call(l)}}})).getDispose((function(t){a.push(t)})),xn(this.targetEl.el,(function(){for(;a.length;)a.pop()()}))}var Cu=function(){return t=function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.targetEl=e,this.eventMap=function(){var t=new Map;function e(e,r){var n;return t.has(e)&&(n=t.get(e),Array.isArray(n)&&n.push(r)||!1)||t.set(e,[].concat(r))}function r(e,r){var n,o;return t.has(e)&&(o=(n=t.get(e)).indexOf(r))>=0&&n.splice(o,1)&&0===t.get(e).length&&t.delete(e)}return{get current(){return t},on:e,once:function(t,n){var o=function(){for(var e=arguments.length,i=new Array(e),l=0;l<e;l++)i[l]=arguments[l];n.call.apply(n,[null].concat(i)),r(t,o)};return e(t,o)},fire:function(e,r){return t.has(e)&&function(){var n,o,i=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Dt(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){l=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(l)throw o}}}}(t.get(e));try{for(i.s();!(n=i.n()).done;){var l=n.value;l.call.apply(l,[null].concat(function(t){if(Array.isArray(t))return Bt(t)}(o=r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||Dt(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}}catch(t){i.e(t)}finally{i.f()}}()},removeListener:r,removeAllListeners:function(){t.clear()}}}();var o=r.settings,l=(o.view,o.showToolbar),a=o.showContextmenu;this.el=i("div","".concat(Wt,"-sheet")),this.toolbar=new Hc(e,r,!l),this.print=new mn(r),e.children(this.toolbar.el,this.el,this.print.el),this.data=r,this.tableEl=i("canvas","".concat(Wt,"-table")),this.rowResizer=new $t(!1,r.rows.height),this.colResizer=new $t(!0,r.cols.minWidth),this.verticalScrollbar=new qt(!0),this.horizontalScrollbar=new qt(!1),this.editor=new tr(Ir,(function(){return n.getTableOffset()}),r.rows.height),this.contextMenu=new Hn(e,(function(){return n.getRect()}),!a),this.selector=new ve(r),this.overlayerCEl=i("div","".concat(Wt,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=i("div","".concat(Wt,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new Yc(this.targetEl),this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.sortFilter.el),this.table=new ln(this.tableEl.el,r),_u.call(this),uu.call(this),eu.call(this,!1,0,0)},e=[{key:"on",value:function(t,e){return this.eventMap.on(t,e),this}},{key:"trigger",value:function(t){for(var e=this.eventMap,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];e.fire(t,n)}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,lu.call(this),au.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}},{key:"loadData",value:function(t){return this.data.setData(t),uu.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),uu.call(this),this}},{key:"undo",value:function(){this.data.undo(),uu.call(this)}},{key:"redo",value:function(){this.data.redo(),uu.call(this)}},{key:"reload",value:function(){return uu.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,r=t.cols,n=this.getRect(),o=n.width,i=n.height;return{width:o-r.indexWidth,height:i-e.height,left:r.indexWidth,top:e.height}}}],e&&Kc(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Au(t){return Au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au(t)}function Ru(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Iu(n.key),n)}}function Iu(t){var e=function(t){if("object"!=Au(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Au(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Au(e)?e:e+""}var Du=function(){return t=function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=i("div","".concat(Wt,"-form-input")),this.input=i("input","").css("width",e).on("input",(function(t){return n.vchange(t)})).attr("placeholder",r),this.el.child(this.input)},(e=[{key:"focus",value:function(){var t=this;setTimeout((function(){t.input.el.focus()}),10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&Ru(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Bu(t){return Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bu(t)}function zu(t){return function(t){if(Array.isArray(t))return Hu(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Mu(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mu(t,e){if(t){if("string"==typeof t)return Hu(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Hu(t,e):void 0}}function Hu(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Nu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Uu(n.key),n)}}function Fu(t,e,r){return e&&Wu(t.prototype,e),r&&Wu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Uu(t){var e=function(t){if("object"!=Bu(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Bu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Bu(e)?e:e+""}function Lu(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Lu=function(){return!!t})()}function $u(t){return $u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$u(t)}function Vu(t,e){return Vu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Vu(t,e)}var Yu=function(t){function e(t,r){var n;return Nu(this,e),(n=function(t,e,r){return e=$u(e),function(t,e){if(e&&("object"==Bu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Lu()?Reflect.construct(e,r||[],$u(t).constructor):e.apply(t,r))}(this,e,[t,new Ae("ellipsis"),"auto",!1,"top-left"])).contentClick=r,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vu(t,e)}(e,t),Fu(e,[{key:"reset",value:function(t){var e=this,r=t.map((function(t,r){return i("div","".concat(Wt,"-item")).css("width","150px").css("font-weight","normal").on("click",(function(){e.contentClick(r),e.hide()})).child(t)}));this.setContentChildren.apply(this,zu(r))}},{key:"setTitle",value:function(){}}])}(no),Xu=[{key:"delete",title:bt("contextmenu.deleteSheet")}];function qu(t){var e=this;return i("div","".concat(Wt,"-item")).child(t.title()).on("click",(function(){e.itemClick(t.key),e.hide()}))}function Ku(){var t=this;return Xu.map((function(e){return qu.call(t,e)}))}var Zu=function(){return Fu((function t(e){var r;Nu(this,t),this.targetEl=e,this.el=(r=i("div","".concat(Wt,"-contextmenu")).css("width","160px")).children.apply(r,zu(Ku.call(this))).hide(),this.itemClick=function(){}}),[{key:"hide",value:function(){this.el.hide()}},{key:"setOffset",value:function(t){var e=this,r=this.el;r.offset(t),r.show();var n=kn(this.targetEl.el,r.el,(function(){return e.hide()}),!1);_n(r.el,n)}}])}(),Ju=function(){return Fu((function t(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};Nu(this,t),this.targetEl=e,this.swapFunc=o,this.updateFunc=a,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new Yu(e,(function(t){r.clickSwap2(r.items[t])})),this.contextMenu=new Zu(this.targetEl),this.contextMenu.itemClick=l,this.el=i("div","".concat(Wt,"-bottombar")).children(this.contextMenu.el,this.menuEl=i("ul","".concat(Wt,"-menu")).child(i("li","").children(new Ae("add").on("click",(function(){n()})),i("span","").child(this.moreEl))))}),[{key:"addItem",value:function(t,e,r){var n=this;this.dataNames.push(t);var o=i("li",e?"active":"").child(t);o.on("click",(function(){n.clickSwap2(o)})).on("contextmenu",(function(t){if("read"!==r.mode){var e=t.target,i=e.offsetLeft,l=e.offsetHeight;n.contextMenu.setOffset({left:i,bottom:l+1}),n.deleteEl=o}})).on("dblclick",(function(){if("read"!==r.mode){var t=o.html(),e=new Du("auto","");e.val(t),e.input.on("blur",(function(e){var r=e.target.value,o=n.dataNames.findIndex((function(e){return e===t}));n.renameItem(o,r)})),o.html("").child(e.el),e.focus()}})),e&&this.clickSwap(o),this.items.push(o),this.menuEl.child(o),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach((function(e){t.menuEl.removeChild(e.el)})),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t,e,r=this.activeEl,n=this.deleteEl;if(this.items.length>1){var o=this.items.findIndex((function(t){return t===n}));if(this.items.splice(o,1),this.dataNames.splice(o,1),this.menuEl.removeChild(n.el),this.moreEl.reset(this.dataNames),r===n){var i=(t=this.items,e=1,function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(t,e)||Mu(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return this.activeEl=i,this.activeEl.toggle(),[o,0]}return[o,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex((function(e){return e===t}));this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}])}();function Gu(t){return Gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gu(t)}function Qu(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ts(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function es(t,e,r){return(e=ns(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rs(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ns(n.key),n)}}function ns(t){var e=function(t){if("object"!=Gu(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Gu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Gu(e)?e:e+""}Object.prototype.hasOwnProperty("_uuid")||Object.defineProperty(Object.prototype,"_uuid",{enumerable:!1,get:function(){return void 0===this.__uuid&&Object.defineProperty(this,"__uuid",{value:jn(32),enumerable:!1,writable:!1}),this.__uuid}});var os=function(){return function(t,e,r){return e&&rs(t.prototype,e),r&&rs(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o=e;this.options=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ts(Object(r),!0).forEach((function(e){es(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ts(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({showBottomBar:!0},n),this.sheetIndex=1,this.datas=[],"string"==typeof e&&(o=document.querySelector(e)),this.targetEl=i(o);var l=i("div","".concat(Wt)).on("contextmenu",(function(t){return t.preventDefault()}));this.bottombar=this.options.showBottomBar?new Ju(l,(function(){if("read"!==r.options.mode){var t=r.addSheet();r.sheet.resetData(t)}}),(function(t){var e=r.datas[t];r.sheet.resetData(e)}),(function(){r.deleteSheet()}),(function(t,e){r.datas[t].name=e,r.sheet.trigger("change")})):null,this.data=this.addSheet(),o.appendChild(l.el),this.sheet=new Cu(l,this.data),null!==this.bottombar&&l.child(this.bottombar.el)}),[{key:"addSheet",value:function(t){var e=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t||"sheet".concat(this.sheetIndex),o=new It(this.targetEl,n,this.options);return o.change=function(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];(t=e.sheet).trigger.apply(t,["change"].concat(n))},this.datas.push(o),null!==this.bottombar&&this.bottombar.addItem(n,r,this.options),this.sheetIndex+=1,o}},{key:"deleteSheet",value:function(){if(null!==this.bottombar){var t=(n=this.bottombar.deleteItem(),o=2,function(t){if(Array.isArray(t))return t}(n)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,l,a=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(n,o)||function(t,e){if(t){if("string"==typeof t)return Qu(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qu(t,e):void 0}}(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e=t[0],r=t[1];e>=0&&(this.datas.splice(e,1),r>=0&&this.sheet.resetData(this.datas[r]),this.sheet.trigger("change"))}var n,o}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],e.length>0)for(var r=0;r<e.length;r+=1){var n=e[r],o=this.addSheet(n.name,0===r);o.setData(n),0===r&&this.sheet.resetData(o)}return this}},{key:"getData",value:function(){return this.datas.map((function(t){return t.getData()}))}},{key:"cellText",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[n].setCellText(t,e,r,"finished"),this}},{key:"cell",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[r].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[r].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"change",value:function(t){return this.sheet.on("change",t),this}}],[{key:"locale",value:function(t,e){mt(t,e)}}])}();window&&(window.x_spreadsheet=function(t){return new os(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})},window.x_spreadsheet.locale=function(t,e){return mt(t,e)})})();
//# sourceMappingURL=xspreadsheet.js.map